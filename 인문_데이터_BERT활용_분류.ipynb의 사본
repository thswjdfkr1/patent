{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1c2NOBk9ofnDjgsY6gCllgrIz7z6hC5S-","timestamp":1716031257889},{"file_id":"https://github.com/Esantomi/digital-humanities/blob/main/%EC%9D%B8%EB%AC%B8%EC%A7%80%EC%8B%9D%EC%B2%98%EB%A6%AC%EC%99%80%ED%86%B5%EA%B3%84/07_%EB%94%A5%EB%9F%AC%EB%8B%9D_%EC%96%B8%EC%96%B4_%EB%B6%84%EB%A5%98_with_BERT.ipynb","timestamp":1682404695032}],"gpuType":"T4"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"b2280c5abd394c63966e2b63dba8f61d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d854bd7478b641e8aa41db549fc5b96a","IPY_MODEL_2338027c7ba5424291d722a0a690eec7","IPY_MODEL_7fe659606c7a4b2da9e26dfe0035cf30"],"layout":"IPY_MODEL_74789f52789f4802b53d89069b9830a4"}},"d854bd7478b641e8aa41db549fc5b96a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4226a1ab3fef47a986043eff730e6027","placeholder":"​","style":"IPY_MODEL_3362a82e490244378a77fcf1b6f1b753","value":"tokenizer_config.json: 100%"}},"2338027c7ba5424291d722a0a690eec7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_df9e0a3650904d04b37499d90356d9be","max":49,"min":0,"orientation":"horizontal","style":"IPY_MODEL_098f386a8fa14b19900acce8f5714863","value":49}},"7fe659606c7a4b2da9e26dfe0035cf30":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7acc34e86dd241a5b7224dae2e15f86d","placeholder":"​","style":"IPY_MODEL_2025e41a13b545cd9e585e4ed21c90e0","value":" 49.0/49.0 [00:00&lt;00:00, 1.31kB/s]"}},"74789f52789f4802b53d89069b9830a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4226a1ab3fef47a986043eff730e6027":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3362a82e490244378a77fcf1b6f1b753":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"df9e0a3650904d04b37499d90356d9be":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"098f386a8fa14b19900acce8f5714863":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7acc34e86dd241a5b7224dae2e15f86d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2025e41a13b545cd9e585e4ed21c90e0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d2b8004db88c41dd9bde5d8c508cf8ad":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5cfbc8ac8453412b871efc1346606283","IPY_MODEL_c555769be0ab44fa8e7fb7686f6a667d","IPY_MODEL_d3969734789a42849caced26e6d264c4"],"layout":"IPY_MODEL_93de99b7535b4ac3973dc37075fd78eb"}},"5cfbc8ac8453412b871efc1346606283":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3f79d57c09c0409eb2ce90304accf29f","placeholder":"​","style":"IPY_MODEL_9de76da3fd5f46848624af2d7f9b1696","value":"vocab.txt: 100%"}},"c555769be0ab44fa8e7fb7686f6a667d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d389aaa2215e4fbc8582a4c45afec34a","max":995526,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5fbae5f712ac4a628407511fc8b26331","value":995526}},"d3969734789a42849caced26e6d264c4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_309df7e360af4e3197f7c54ec4cbcb5c","placeholder":"​","style":"IPY_MODEL_35f54504bd1d452697e71cc7c98025f2","value":" 996k/996k [00:00&lt;00:00, 4.16MB/s]"}},"93de99b7535b4ac3973dc37075fd78eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3f79d57c09c0409eb2ce90304accf29f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9de76da3fd5f46848624af2d7f9b1696":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d389aaa2215e4fbc8582a4c45afec34a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5fbae5f712ac4a628407511fc8b26331":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"309df7e360af4e3197f7c54ec4cbcb5c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"35f54504bd1d452697e71cc7c98025f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c2facae476e14f80bb4c2cfc6921732c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d29af976e39544e0a35134147cec7ee4","IPY_MODEL_aea7ab2ace25471eb31b7dab25a98682","IPY_MODEL_4261727196984bf5aa769e371eb303b9"],"layout":"IPY_MODEL_af9773e498044498a71f91046f5fb73e"}},"d29af976e39544e0a35134147cec7ee4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_736d0d17666b45de8672f384250d39bc","placeholder":"​","style":"IPY_MODEL_d1e7118597d54ebba3480a8346da8a09","value":"tokenizer.json: 100%"}},"aea7ab2ace25471eb31b7dab25a98682":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_709a29f7a9f1413c9dd26baa062a134e","max":1961828,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d02f65eca1234ac2ae69a19531ac2029","value":1961828}},"4261727196984bf5aa769e371eb303b9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ec1dfd60a0cb4553b423e19728a2c2a8","placeholder":"​","style":"IPY_MODEL_22b5de5ad3e44be19ea591d4cca14844","value":" 1.96M/1.96M [00:00&lt;00:00, 25.6MB/s]"}},"af9773e498044498a71f91046f5fb73e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"736d0d17666b45de8672f384250d39bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d1e7118597d54ebba3480a8346da8a09":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"709a29f7a9f1413c9dd26baa062a134e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d02f65eca1234ac2ae69a19531ac2029":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ec1dfd60a0cb4553b423e19728a2c2a8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"22b5de5ad3e44be19ea591d4cca14844":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7c88ed548b3f4b3fbbae6783383a29e2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_79c9e24ce62b4a3b99d3332cb47ce4af","IPY_MODEL_489e216639a043869a317dd90db1d6fa","IPY_MODEL_4e44b47c29624944baff34908720a2eb"],"layout":"IPY_MODEL_aa8622725b3741d6b86e5a05e57c8761"}},"79c9e24ce62b4a3b99d3332cb47ce4af":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_98f700c6f132457383f14f9e107377a8","placeholder":"​","style":"IPY_MODEL_4c03150ef15c4afa988352f7b22e68cd","value":"config.json: 100%"}},"489e216639a043869a317dd90db1d6fa":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_afc3eb470fe34a93adfc064a885bf101","max":625,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d85f442b302940ddb6df3007cfa5544d","value":625}},"4e44b47c29624944baff34908720a2eb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5f251ab69241497098b2676824245287","placeholder":"​","style":"IPY_MODEL_8057280cc91f450d903f94041b0e8903","value":" 625/625 [00:00&lt;00:00, 14.6kB/s]"}},"aa8622725b3741d6b86e5a05e57c8761":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"98f700c6f132457383f14f9e107377a8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4c03150ef15c4afa988352f7b22e68cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"afc3eb470fe34a93adfc064a885bf101":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d85f442b302940ddb6df3007cfa5544d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5f251ab69241497098b2676824245287":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8057280cc91f450d903f94041b0e8903":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f34f68549e2f431cb8f6d1907045316a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_72c249e3ac594fd5a0de32c75d515538","IPY_MODEL_4d2a69a5888d46418129523da0cfa0e2","IPY_MODEL_9eadf62e19b8408b858a45ea2e816712"],"layout":"IPY_MODEL_a98d2f717a4d405ca3a4777959795a29"}},"72c249e3ac594fd5a0de32c75d515538":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9a727696d7954071b6269a3a7c0aefd1","placeholder":"​","style":"IPY_MODEL_625a03389da84322a1d0f6dc299cc7be","value":"model.safetensors: 100%"}},"4d2a69a5888d46418129523da0cfa0e2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_65a80817ccfd42ec9bfc9c32f7241973","max":714290682,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e6fdda2ffca94409939536c3fdfc3a20","value":714290682}},"9eadf62e19b8408b858a45ea2e816712":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_edb2ff3404d74a4da9be3e144fe51732","placeholder":"​","style":"IPY_MODEL_c002411a8f364a8eaeddcf96e6852e71","value":" 714M/714M [00:06&lt;00:00, 137MB/s]"}},"a98d2f717a4d405ca3a4777959795a29":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a727696d7954071b6269a3a7c0aefd1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"625a03389da84322a1d0f6dc299cc7be":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"65a80817ccfd42ec9bfc9c32f7241973":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e6fdda2ffca94409939536c3fdfc3a20":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"edb2ff3404d74a4da9be3e144fe51732":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c002411a8f364a8eaeddcf96e6852e71":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"accelerator":"GPU"},"cells":[{"cell_type":"markdown","metadata":{"id":"55F3hYP0gFKg"},"source":["# BERT을 통한 딥러닝 분류 학습\n","\n","사용 알고리즘:  BERT Fine-Tuning Tutorial with PyTorch\n","-> https://mccormickml.com/2019/07/22/BERT-fine-tuning\n","\n","사용 데이터: Naver sentiment movie corpus v1.0\n","https://github.com/e9t/nsmc.git\n","\n","* 본 내용은 https://github.com/deepseasw/bert-naver-movie-review 를 토대로 수정하였습니다. deepseasw님께 감사 드립니다.\n"]},{"cell_type":"markdown","source":["## 환경 설정"],"metadata":{"id":"SMj99TL8KtI_"}},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yJfNqmbhf-PK","outputId":"e687f684-2813-481b-ebeb-5a11f498fa18","executionInfo":{"status":"ok","timestamp":1716190192157,"user_tz":-540,"elapsed":32679,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 환경설정\n","\n","# Hugging Face의 트랜스포머 모델을 설치\n","!pip install transformers\n","\n","import sys\n","\n","from IPython.display import clear_output\n","clear_output(wait=True)\n","\n","## 관련 라이브러스 설치\n","import tensorflow as tf\n","\n","import torch\n","from torch.utils.data import TensorDataset, DataLoader, RandomSampler, SequentialSampler\n","\n","from transformers import BertTokenizer\n","from transformers import BertForSequenceClassification, AdamW, BertConfig\n","from transformers import get_linear_schedule_with_warmup\n","\n","import keras\n","# from keras.preprocessing.sequence import pad_sequences  # path removed\n","from keras.utils import pad_sequences\n","\n","from sklearn.model_selection import train_test_split\n","\n","import pandas as pd\n","import numpy as np\n","import random\n","import time\n","import datetime\n","\n","clear_output()\n","\n","print('Python version : ', sys.version)\n","print('TensorFlow version : ', tf.__version__)\n","print('Keras version : ', keras.__version__)"],"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Python version :  3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0]\n","TensorFlow version :  2.15.0\n","Keras version :  2.15.0\n"]}]},{"cell_type":"markdown","metadata":{"id":"6hhNxGZlhDgo"},"source":["## 데이터 불러오기"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":736},"id":"WbltToQGE9xB","outputId":"e12e3e33-9d13-429c-b2da-3f5affa25ec2","executionInfo":{"status":"ok","timestamp":1716190201133,"user_tz":-540,"elapsed":4454,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 데이터 불러오기 - 조중동/한경 기사 데이터\n","파일ID = '1Md8XHJADQWzO1mcl0ZnOm5ijp_cL8G4F'  #@param {type: \"string\"}\n","파일저장이름 = 'rawdata.tsv'  #@param {type: \"string\"}\n","\n","# 문서 ID로 실제 파일 불러오는 법\n","## 조중동한경_정치만_각각_20220510-20230523 : https://drive.google.com/file/d/1Md8XHJADQWzO1mcl0ZnOm5ijp_cL8G4F/\n","\n","!wget --load-cookies ~/cookies.txt \"https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies ~/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id={파일ID}' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\\1\\n/p')&id={파일ID}\" -O {파일저장이름} && rm -rf ~/cookies.txt\n","\n","print(파일저장이름+\"을 정상적으로 가져왔습니다.\")\n","\n","# pandas import\n","import pandas as pd\n","\n","# 파일을 DataFrame으로 전환\n","df = pd.read_csv(파일저장이름, sep='\\t')\n","df = df.dropna(axis=0)\n","df"],"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["--2024-05-20 07:30:33--  https://docs.google.com/uc?export=download&confirm=&id=1Md8XHJADQWzO1mcl0ZnOm5ijp_cL8G4F\n","Resolving docs.google.com (docs.google.com)... 74.125.20.113, 74.125.20.138, 74.125.20.100, ...\n","Connecting to docs.google.com (docs.google.com)|74.125.20.113|:443... connected.\n","HTTP request sent, awaiting response... 303 See Other\n","Location: https://drive.usercontent.google.com/download?id=1Md8XHJADQWzO1mcl0ZnOm5ijp_cL8G4F&export=download [following]\n","--2024-05-20 07:30:33--  https://drive.usercontent.google.com/download?id=1Md8XHJADQWzO1mcl0ZnOm5ijp_cL8G4F&export=download\n","Resolving drive.usercontent.google.com (drive.usercontent.google.com)... 173.194.203.132, 2607:f8b0:400e:c02::84\n","Connecting to drive.usercontent.google.com (drive.usercontent.google.com)|173.194.203.132|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 7737408 (7.4M) [application/octet-stream]\n","Saving to: ‘rawdata.tsv’\n","\n","rawdata.tsv         100%[===================>]   7.38M  --.-KB/s    in 0.09s   \n","\n","2024-05-20 07:30:34 (80.0 MB/s) - ‘rawdata.tsv’ saved [7737408/7737408]\n","\n","rawdata.tsv을 정상적으로 가져왔습니다.\n"]},{"output_type":"execute_result","data":{"text/plain":["      label                                               text\n","0      경향신문             이낙연 “미국도 할 말 하는 동맹 원할 것 한국 정치 길 잃은 상태”\n","1      경향신문  윤재옥 “공직자윤리법, 국회의원만이라도 빠르게 가상자산 신고할 수 있도록 수정안 낼 것”\n","2      경향신문                     이정미 “노무현 정신 기준에서 정치권 스스로 돌아봐야”\n","3      경향신문                          민주당, 성추행 고소당한 부천시의원 조사 착수\n","4      경향신문                   민주당, 박민식 부적격 기류  인사청문보고서 채택 불발되나\n","...     ...                                                ...\n","81248  동아일보                            국정원장 김규현 내정 북미라인 외교-안보통\n","81249  동아일보                    한동훈 “국민 보시기 불편 송구하다” 자녀 의혹 첫 사과\n","81250  동아일보             윤석열 대통령, 공식 임기 시작 0시 용산벙커에서 합참 보고 첫 업무\n","81251  동아일보                                  [사설]윤석열 대통령에게 바란다\n","81252  동아일보                [사설]한동훈, 딸 재산 의혹 국민 눈높이에서 겸허하게 해명하라\n","\n","[81253 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-adc863de-64c0-4350-ae8c-daab217d373b\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>label</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>경향신문</td>\n","      <td>이낙연 “미국도 할 말 하는 동맹 원할 것 한국 정치 길 잃은 상태”</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>경향신문</td>\n","      <td>윤재옥 “공직자윤리법, 국회의원만이라도 빠르게 가상자산 신고할 수 있도록 수정안 낼 것”</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>경향신문</td>\n","      <td>이정미 “노무현 정신 기준에서 정치권 스스로 돌아봐야”</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>경향신문</td>\n","      <td>민주당, 성추행 고소당한 부천시의원 조사 착수</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>경향신문</td>\n","      <td>민주당, 박민식 부적격 기류  인사청문보고서 채택 불발되나</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>81248</th>\n","      <td>동아일보</td>\n","      <td>국정원장 김규현 내정 북미라인 외교-안보통</td>\n","    </tr>\n","    <tr>\n","      <th>81249</th>\n","      <td>동아일보</td>\n","      <td>한동훈 “국민 보시기 불편 송구하다” 자녀 의혹 첫 사과</td>\n","    </tr>\n","    <tr>\n","      <th>81250</th>\n","      <td>동아일보</td>\n","      <td>윤석열 대통령, 공식 임기 시작 0시 용산벙커에서 합참 보고 첫 업무</td>\n","    </tr>\n","    <tr>\n","      <th>81251</th>\n","      <td>동아일보</td>\n","      <td>[사설]윤석열 대통령에게 바란다</td>\n","    </tr>\n","    <tr>\n","      <th>81252</th>\n","      <td>동아일보</td>\n","      <td>[사설]한동훈, 딸 재산 의혹 국민 눈높이에서 겸허하게 해명하라</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>81253 rows × 2 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-adc863de-64c0-4350-ae8c-daab217d373b')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-adc863de-64c0-4350-ae8c-daab217d373b button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-adc863de-64c0-4350-ae8c-daab217d373b');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-01ea6907-5e5b-4429-b374-992ac5a74106\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-01ea6907-5e5b-4429-b374-992ac5a74106')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-01ea6907-5e5b-4429-b374-992ac5a74106 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_7fc1683d-c509-45cf-b97b-204dce055933\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_7fc1683d-c509-45cf-b97b-204dce055933 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('df');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df","summary":"{\n  \"name\": \"df\",\n  \"rows\": 81253,\n  \"fields\": [\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"\\uc870\\uc120\\uc77c\\ubcf4\",\n          \"\\ub3d9\\uc544\\uc77c\\ubcf4\",\n          \"\\uc911\\uc559\\uc77c\\ubcf4\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"text\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 80845,\n        \"samples\": [\n          \"DPR, \\ub7ec \\ub300\\uc0ac\\uad00 \\uac1c\\uad00 \\u201c\\ubd81\\ud55c\\uacfc \\ub3c5\\ub9bd\\uad6d \\uc2b9\\uc778 \\ud611\\uc0c1 \\uc9c4\\ud589 \\uc911\\u201d\",\n          \"The Presidential Office Received a Report on the IRA Before the President\\u2019s Phone Call with Speaker Pelosi\",\n          \"\\uc774\\uc7ac\\uba85, \\u5c39 \\ubc1c\\uc5b8 \\ub17c\\ub780\\uc5d0 \\u201c\\ub0a0\\ub9ac\\uba74\\uc73c\\ub85c \\ub4e4\\ub9b4 \\uc218\\ub3c4 \\uc0ac\\uc2e4 \\ud655\\uc778\\ud574\\uc57c\\u201d\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":2}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_sJzeaX-Io4K","outputId":"c5c341d6-f3d8-46b8-a539-87770c0b9576","executionInfo":{"status":"ok","timestamp":1716190202808,"user_tz":-540,"elapsed":493,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 데이터 선택하기\n","\n","데이터량 = \"81253\"  #@param ['100', '1000', '5000','10000', '50000', '81253']\n","데이터량 = int(데이터량)\n","\n","df = df.iloc[:데이터량]\n","print(df)\n","\n","print(df[\"label\"].groupby([df[\"label\"]]).count())"],"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["      label                                               text\n","0      경향신문             이낙연 “미국도 할 말 하는 동맹 원할 것 한국 정치 길 잃은 상태”\n","1      경향신문  윤재옥 “공직자윤리법, 국회의원만이라도 빠르게 가상자산 신고할 수 있도록 수정안 낼 것”\n","2      경향신문                     이정미 “노무현 정신 기준에서 정치권 스스로 돌아봐야”\n","3      경향신문                          민주당, 성추행 고소당한 부천시의원 조사 착수\n","4      경향신문                   민주당, 박민식 부적격 기류  인사청문보고서 채택 불발되나\n","...     ...                                                ...\n","81248  동아일보                            국정원장 김규현 내정 북미라인 외교-안보통\n","81249  동아일보                    한동훈 “국민 보시기 불편 송구하다” 자녀 의혹 첫 사과\n","81250  동아일보             윤석열 대통령, 공식 임기 시작 0시 용산벙커에서 합참 보고 첫 업무\n","81251  동아일보                                  [사설]윤석열 대통령에게 바란다\n","81252  동아일보                [사설]한동훈, 딸 재산 의혹 국민 눈높이에서 겸허하게 해명하라\n","\n","[81253 rows x 2 columns]\n","label\n","경향신문    18534\n","동아일보    14910\n","조선일보    16401\n","중앙일보    20000\n","한겨레     11408\n","Name: label, dtype: int64\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Yjx1mpFCTsIK","outputId":"cdd80a99-5d6c-46a0-a1d3-4eb685b2405a","executionInfo":{"status":"ok","timestamp":1716190207657,"user_tz":-540,"elapsed":3322,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["## 텍스트로 되어 있는 라벨을 숫자로 변환\n","df.loc[df.label=='조선일보', 'label']='0'\n","df.loc[df.label=='중앙일보', 'label']='0'\n","df.loc[df.label=='동아일보', 'label']='0'\n","df.loc[df.label=='한겨레', 'label']='1'\n","df.loc[df.label=='경향신문', 'label']='1'\n","# df.loc[df.label=='분류추가', 'label']='2'\n","\n","## label 값을 숫자로 전환\n","df['label'] = df['label'].apply(pd.to_numeric)\n","\n","print(df)"],"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["       label                                               text\n","0          1             이낙연 “미국도 할 말 하는 동맹 원할 것 한국 정치 길 잃은 상태”\n","1          1  윤재옥 “공직자윤리법, 국회의원만이라도 빠르게 가상자산 신고할 수 있도록 수정안 낼 것”\n","2          1                     이정미 “노무현 정신 기준에서 정치권 스스로 돌아봐야”\n","3          1                          민주당, 성추행 고소당한 부천시의원 조사 착수\n","4          1                   민주당, 박민식 부적격 기류  인사청문보고서 채택 불발되나\n","...      ...                                                ...\n","81248      0                            국정원장 김규현 내정 북미라인 외교-안보통\n","81249      0                    한동훈 “국민 보시기 불편 송구하다” 자녀 의혹 첫 사과\n","81250      0             윤석열 대통령, 공식 임기 시작 0시 용산벙커에서 합참 보고 첫 업무\n","81251      0                                  [사설]윤석열 대통령에게 바란다\n","81252      0                [사설]한동훈, 딸 재산 의혹 국민 눈높이에서 겸허하게 해명하라\n","\n","[81253 rows x 2 columns]\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VvM9RbCjTs_3","outputId":"618227e3-13c0-4937-aee7-c6b85487f77e","executionInfo":{"status":"ok","timestamp":1716190208791,"user_tz":-540,"elapsed":5,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 훈련 데이터 비율 선택하기\n","\n","훈련데이터비율 = 0.9  #@param ['0.9', '0.8', '0.7', '0.6']\n","\n","## 훈련데이터와 테스트데이터로 분리\n","train=df.sample(frac=훈련데이터비율,random_state=200)\n","test=df.drop(train.index)\n","\n","train.drop_duplicates(subset = ['text'], inplace=True) # text 열에서 중복인 내용이 있다면 중복 제거\n","train['text'] = train['text'].str.replace(\"[^ㄱ-ㅎㅏ-ㅣ가-힣 ]\",\"\") # 정규 표현식 수행\n","train['text'].replace('', np.nan, inplace=True) # 공백은 Null 값으로 변경\n","train = train.dropna(how='any') # Null 값 제거\n","print('전처리 후 훈련용 샘플의 개수 :',len(train))\n","\n","test.drop_duplicates(subset = ['text'], inplace=True) # text 열에서 중복인 내용이 있다면 중복 제거\n","test['text'] = test['text'].str.replace(\"[^ㄱ-ㅎㅏ-ㅣ가-힣 ]\",\"\") # 정규 표현식 수행\n","test['text'].replace('', np.nan, inplace=True) # 공백은 Null 값으로 변경\n","test = test.dropna(how='any') # Null 값 제거\n","print('전처리 후 테스트용 샘플의 개수 :',len(test))\n"],"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["전처리 후 훈련용 샘플의 개수 : 72782\n","전처리 후 테스트용 샘플의 개수 : 8117\n"]}]},{"cell_type":"markdown","metadata":{"id":"Zq-34YOnjyiC"},"source":["## 데이터 전처리 with bert"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Qap3wqEBiCuW","outputId":"7ca1d3c6-203f-4b69-96c5-11b58505056d","executionInfo":{"status":"ok","timestamp":1716190215958,"user_tz":-540,"elapsed":320,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 학습 데이터 처리 - BERT형식으로 변환\n","\n","# 리뷰 문장 추출\n","sentences = train['text']\n","print('')\n","print('##### 원본 데이터 #####')\n","print(sentences[:10])\n","\n","  # BERT의 입력 형식에 맞게 변환\n","sentences = [\"[CLS] \" + str(sentence) + \" [SEP]\" for sentence in sentences]\n","print('')\n","print('##### Bert 형식으로 변환 #####')\n","print(sentences[:10])\n","\n","\n","  # 라벨 추출\n","labels = train['label'].values\n","\n","print('')\n","print('##### 라벨 추출 #####')\n","print(labels)"],"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","##### 원본 데이터 #####\n","55262            윤, 취임 1주년 날에도 ‘전 정권’ 탓 “잘못 바로잡아온 시간”\n","5367                   황운하, 김기현 향해 “윤 대통령의 꼬리 잘치는 푸들”\n","67660         한동훈 “돈봉투 수사가 정치 탄압? 승부조작 수사하면 스포츠 탄압이냐”\n","77751              고민정 “文전용기 민간인 안타” 박민영 “김영철 탄 사진은?”\n","61333              신재생에너지 뜯어본다는 감사원, 작년 “문제없다” 결론 바꿀까\n","35862               태영호 김재원 버티기에 與 징계수위 고민, 최고회의 또 취소\n","12447    통일부 5년 만에 감소 ‘담대한 구상’ ‘북한인권 증진’ 힘싣기[2023예산안]\n","699                한 일 재무장관 회의도 가동 채비 통상 갈등 해소 물꼬 트이나\n","74905                 “검찰 두려워 할 사람은 범죄자뿐” 한동훈 어록집 나온다\n","55892           “송영길 있어야 할 곳, 프랑스 아닌 국민 앞” 민주당, 귀국 촉구\n","Name: text, dtype: object\n","\n","##### Bert 형식으로 변환 #####\n","['[CLS] 윤, 취임 1주년 날에도 ‘전 정권’ 탓 “잘못 바로잡아온 시간” [SEP]', '[CLS] 황운하, 김기현 향해 “윤 대통령의 꼬리 잘치는 푸들” [SEP]', '[CLS] 한동훈 “돈봉투 수사가 정치 탄압? 승부조작 수사하면 스포츠 탄압이냐” [SEP]', '[CLS] 고민정 “文전용기 민간인 안타” 박민영 “김영철 탄 사진은?” [SEP]', '[CLS] 신재생에너지 뜯어본다는 감사원, 작년 “문제없다” 결론 바꿀까 [SEP]', '[CLS] 태영호 김재원 버티기에 與 징계수위 고민, 최고회의 또 취소 [SEP]', '[CLS] 통일부 5년 만에 감소 ‘담대한 구상’ ‘북한인권 증진’ 힘싣기[2023예산안] [SEP]', '[CLS] 한 일 재무장관 회의도 가동 채비 통상 갈등 해소 물꼬 트이나 [SEP]', '[CLS] “검찰 두려워 할 사람은 범죄자뿐” 한동훈 어록집 나온다 [SEP]', '[CLS] “송영길 있어야 할 곳, 프랑스 아닌 국민 앞” 민주당, 귀국 촉구 [SEP]']\n","\n","##### 라벨 추출 #####\n","[1 1 0 ... 1 0 0]\n"]}]},{"cell_type":"markdown","metadata":{"id":"wfLrcP0ej6l0"},"source":["![대체 텍스트](https://mino-park7.github.io/images/2019/02/bert-input-representation.png)\n","\n","BERT의 입력은 위의 그림과 같은 형식입니다. Classification을 뜻하는 [CLS] 심볼이 제일 앞에 삽입됩니다. 파인튜닝시 출력에서 이 위치의 값을 사용하여 분류를 합니다. [SEP]은 Separation을 가리키는데, 두 문장을 구분하는 역할을 합니다. 이 예제에서는 문장이 하나이므로 [SEP]도 하나만 넣습니다.\n","<br>\n","<br>"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":292,"referenced_widgets":["b2280c5abd394c63966e2b63dba8f61d","d854bd7478b641e8aa41db549fc5b96a","2338027c7ba5424291d722a0a690eec7","7fe659606c7a4b2da9e26dfe0035cf30","74789f52789f4802b53d89069b9830a4","4226a1ab3fef47a986043eff730e6027","3362a82e490244378a77fcf1b6f1b753","df9e0a3650904d04b37499d90356d9be","098f386a8fa14b19900acce8f5714863","7acc34e86dd241a5b7224dae2e15f86d","2025e41a13b545cd9e585e4ed21c90e0","d2b8004db88c41dd9bde5d8c508cf8ad","5cfbc8ac8453412b871efc1346606283","c555769be0ab44fa8e7fb7686f6a667d","d3969734789a42849caced26e6d264c4","93de99b7535b4ac3973dc37075fd78eb","3f79d57c09c0409eb2ce90304accf29f","9de76da3fd5f46848624af2d7f9b1696","d389aaa2215e4fbc8582a4c45afec34a","5fbae5f712ac4a628407511fc8b26331","309df7e360af4e3197f7c54ec4cbcb5c","35f54504bd1d452697e71cc7c98025f2","c2facae476e14f80bb4c2cfc6921732c","d29af976e39544e0a35134147cec7ee4","aea7ab2ace25471eb31b7dab25a98682","4261727196984bf5aa769e371eb303b9","af9773e498044498a71f91046f5fb73e","736d0d17666b45de8672f384250d39bc","d1e7118597d54ebba3480a8346da8a09","709a29f7a9f1413c9dd26baa062a134e","d02f65eca1234ac2ae69a19531ac2029","ec1dfd60a0cb4553b423e19728a2c2a8","22b5de5ad3e44be19ea591d4cca14844","7c88ed548b3f4b3fbbae6783383a29e2","79c9e24ce62b4a3b99d3332cb47ce4af","489e216639a043869a317dd90db1d6fa","4e44b47c29624944baff34908720a2eb","aa8622725b3741d6b86e5a05e57c8761","98f700c6f132457383f14f9e107377a8","4c03150ef15c4afa988352f7b22e68cd","afc3eb470fe34a93adfc064a885bf101","d85f442b302940ddb6df3007cfa5544d","5f251ab69241497098b2676824245287","8057280cc91f450d903f94041b0e8903"]},"id":"2J384Nt7j8nY","outputId":"5206c2f5-2430-46d4-9008-eec7a375c3fe","executionInfo":{"status":"ok","timestamp":1716190242088,"user_tz":-540,"elapsed":23559,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 학습 데이터 처리 - BERT로 토큰화하기\n","\n","bert모델 = \"bert-base-multilingual-cased\"  #@param ['bert-base-multilingual-cased', 'bert-large-cased', 'bert-base-chinese']\n","\n","#\"bert-base-uncased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-config.json\",\n","#\"bert-large-uncased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-uncased-config.json\",\n","#\"bert-base-cased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-cased-config.json\",\n","#\"bert-large-cased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-cased-config.json\",\n","#\"bert-base-multilingual-uncased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-uncased-config.json\",\n","#\"bert-base-multilingual-cased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-config.json\",\n","#\"bert-base-chinese\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-chinese-config.json\",\n","#\"bert-base-german-cased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-german-cased-config.json\",\n","#\"bert-large-uncased-whole-word-masking\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-uncased-whole-word-masking-config.json\",\n","#\"bert-large-cased-whole-word-masking\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-cased-whole-word-masking-config.json\",\n","#\"bert-large-uncased-whole-word-masking-finetuned-squad\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-uncased-whole-word-masking-finetuned-squad-config.json\",\n","#\"bert-large-cased-whole-word-masking-finetuned-squad\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-cased-whole-word-masking-finetuned-squad-config.json\",\n","#\"bert-base-cased-finetuned-mrpc\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-cased-finetuned-mrpc-config.json\",\n","#\"bert-base-german-dbmdz-cased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-german-dbmdz-cased-config.json\",\n","#\"bert-base-german-dbmdz-uncased\": \"https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-german-dbmdz-uncased-config.json\",\n","#\"bert-base-japanese\": \"https://s3.amazonaws.com/models.huggingface.co/bert/cl-tohoku/bert-base-japanese-config.json\",\n","#\"bert-base-japanese-whole-word-masking\": \"https://s3.amazonaws.com/models.huggingface.co/bert/cl-tohoku/bert-base-japanese-whole-word-masking-config.json\",\n","#\"bert-base-japanese-char\": \"https://s3.amazonaws.com/models.huggingface.co/bert/cl-tohoku/bert-base-japanese-char-config.json\",\n","#\"bert-base-japanese-char-whole-word-masking\": \"https://s3.amazonaws.com/models.huggingface.co/bert/cl-tohoku/bert-base-japanese-char-whole-word-masking-config.json\",\n","#\"bert-base-finnish-cased-v1\": \"https://s3.amazonaws.com/models.huggingface.co/bert/TurkuNLP/bert-base-finnish-cased-v1/config.json\",\n","#\"bert-base-finnish-uncased-v1\": \"https://s3.amazonaws.com/models.huggingface.co/bert/TurkuNLP/bert-base-finnish-uncased-v1/config.json\",\n","\n","\n","# BERT의 토크나이저로 문장을 토큰으로 분리\n","tokenizer = BertTokenizer.from_pretrained(bert모델, do_lower_case=False)\n","tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","print (sentences[0])\n","print (tokenized_texts[0])"],"execution_count":7,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/49.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b2280c5abd394c63966e2b63dba8f61d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.txt:   0%|          | 0.00/996k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d2b8004db88c41dd9bde5d8c508cf8ad"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer.json:   0%|          | 0.00/1.96M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c2facae476e14f80bb4c2cfc6921732c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/625 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7c88ed548b3f4b3fbbae6783383a29e2"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["[CLS] 윤, 취임 1주년 날에도 ‘전 정권’ 탓 “잘못 바로잡아온 시간” [SEP]\n","['[CLS]', '윤', ',', '취임', '1', '##주', '##년', '날', '##에도', '[UNK]', '전', '정', '##권', '[UNK]', '탓', '[UNK]', '잘', '##못', '바로', '##잡', '##아', '##온', '시', '##간', '[UNK]', '[SEP]']\n"]}]},{"cell_type":"markdown","metadata":{"id":"SFHdtLXakBFY"},"source":["BERT는 형태소분석으로 토큰을 분리하지 않습니다. WordPiece라는 통계적인 방식을 사용합니다. 한 단어내에서 자주 나오는 글자들을 붙여서 하나의 토큰으로 만듭니다. 이렇게 하면 언어에 상관없이 토큰을 생성할 수 있다는 장점이 있습니다. 또한 신조어 같이 사전에 없는 단어를 처리하기도 좋습니다.\n","\n","위의 결과에서 ## 기호는 앞 토큰과 이어진다는 표시입니다. 토크나이저는 여러 언어의 데이터를 기반으로 만든 'bert-base-multilingual-cased'를 사용합니다. 그래서 한글도 처리가 가능합니다.\n","<br>\n","<br>"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":504},"id":"t3BRIdawlCRj","outputId":"cb7d5f7a-26a6-4ea5-9a2c-2f118103de12","executionInfo":{"status":"ok","timestamp":1716190250094,"user_tz":-540,"elapsed":805,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 전처리를 위한 문장 길이 조회\n","\n","## 전처리를 위한 기본 텍스트 정보를 탐색합니다.\n","\n","최대길이 = \"64\"  #@param ['32', '64', '128', '256']\n","최대길이 = int(최대길이)\n","\n","print('문장의 최대 길이 :',max(len(l) for l in sentences))\n","## 문장의 최대 길이는 가장 긴 문장의 길이를 의미합니다.\n","\n","print('문장의 평균 길이 :',sum(map(len, sentences))/len(sentences))\n","## 문장의 평균 길이는 문장 길이의 평균값을 의미합니다.\n","\n","import matplotlib.pyplot as plt\n","\n","plt.hist([len(s) for s in sentences], bins=50)\n","plt.xlabel('length of samples')\n","plt.ylabel('number of samples')\n","plt.show()\n","\n","## 문장 길이 전체 그래프를 살펴보면, 문장의 전체 분포를 볼 수 있습니다.\n","## 대다수의 문장이 50자 이하인 것을 알 수 있습니다.\n","\n","\n","def below_threshold_len(max_len, nested_list):\n","  cnt = 0\n","  for s in nested_list:\n","    if(len(s) <= max_len):\n","        cnt = cnt + 1\n","  print('전체 샘플 중 길이가 %s 이하인 샘플의 비율: %s'%(max_len, (cnt / len(nested_list))*100))\n","\n","\n","max_len = 최대길이\n","below_threshold_len(max_len, sentences)\n","\n","## max_leb(문장 최대 길이)가 128일때 선택되는 전체 데이터량을 의미합니다.\n","## 현재값은 95.92로 대략 6%를 제외한 모든 데이터가 선택된 것을 확인할 수 있습니다."],"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["문장의 최대 길이 : 180\n","문장의 평균 길이 : 45.901060701821876\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"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eEiSJk2apBUrVui7776TJA0cOFDFxcVauXKlue6uXbuqffv2WrhwoaX+uabJ9XFNEwDg1xz5++3w6bmpU6dq2rRpKigo0KFDh5SVlWU+rjQwXcrGjRsVGBioli1b6oknntCJEyfMsbS0NPn7+5uBSZKio6Pl5uam7du3mzXdu3c3A5MkxcbGKiMjQ6dOnTJroqOj7d43NjZWaWlpv9nX2bNnVVhYaPcAAADVl8Oh6fTp0xo0aNBlP0VXGXr16qW//vWvWrdunV555RVt2rRJvXv3Nj+Vl5ubq8DAQLvX1KpVSwEBAcrNzTVrgoKC7GrKn1+upnz8YpKSkuTn52c+wsLCrm5jAQCAS3M4+YwYMULLli2ril4qGDRokO677z6Fh4erX79+WrlypXbu3KmNGzdek/e/lMmTJ6ugoMB8HDlyxNktAQCAKuTwheDlF0unpKQoPDxctWvXtht/7bXXKq25X2vWrJkaNGiggwcPqmfPngoODtaxY8fsas6fP6+TJ08qODhYkhQcHKy8vDy7mvLnl6spH78YT0/PChelAwCA6svhmaakpCStXr1aeXl52rt3r77++mvzsXv37ipo8f/88MMPOnHihEJCQiRJUVFRys/PV3p6ulmzfv16lZWVKTIy0qzZvHmzSkpKzJrU1FS1bNlS9erVM2vWrVtn916pqamKioqq0u0BAADXD4dnmmbPnq333ntPjz766FW/eVFRkd2X/GZlZWn37t0KCAhQQECAZsyYoQEDBig4OFiZmZl69tln1aJFC8XGxkqSWrdurV69emnkyJFauHChSkpKNHr0aA0aNEihoaGSpIcfflgzZszQiBEjNHHiRO3bt09z587V66+/br7v2LFj1aNHD82ePVtxcXH66KOP9NVXX2nRokVXvY0AAKB6cHimydPTU926dauUN//qq6/UoUMHdejQQZKUmJioDh06aNq0aXJ3d9eePXt033336ZZbbtGIESPUsWNH/etf/7I7LfbBBx+oVatW6tmzp/r06aM77rjDLuz4+flpzZo1ysrKUseOHfX0009r2rRp5j2aJOn222/XkiVLtGjRIrVr106ffPKJVqxYwT2aAACAyeH7NCUlJSknJ0fz5s2rqp6uS9ynyfVxnyYAwK9V6XfP7dixQ+vXr9fKlSt16623VrgQ/NNPP3V0lQAAAC7P4dDk7+//m195AgAAUF05HJou/B44AACAmqLqb+sNAABQDTg80yRJn3zyiT7++GNlZ2fr3LlzdmO7du2qlMYAAABcicMzTfPmzdOwYcMUFBSkr7/+Wl26dFH9+vX1n//8R717966KHgEAAJzO4dD01ltvadGiRXrjjTfk4eGhZ599VqmpqXrqqadUUFBQFT0CAAA4ncOhKTs7W7fffrskydvbWz/99JMkaciQIfrwww8rtzsAAAAX4XBoCg4O1smTJyVJjRo10rZt2yT98hUoDt4nEwAA4LrhcGi655579I9//EOSNGzYMI0fP16/+93vNHDgQD3wwAOV3iAAAIArcPjTc4sWLVJZWZkkKSEhQfXr19fWrVt133336Q9/+EOlNwgAAOAKHA5Nbm5ucnP7vwmqQYMGadCgQZXaFAAAgKtx+PRcSkqKtmzZYj5/88031b59ez388MM6depUpTYHAADgKhwOTc8884wKCwslSXv37lViYqL69OmjrKwsJSYmVnqDAAAArsDh03NZWVlq06aNJOnvf/+7+vbtq5dfflm7du1Snz59Kr1BAAAAV+DwTJOHh4dOnz4tSVq7dq1iYmIkSQEBAeYMFAAAQHXj8EzTHXfcocTERHXr1k07duzQ0qVLJUn//ve/ddNNN1V6gwAAAK7A4Zmm+fPnq1atWvrkk0+0YMEC3XjjjZKkL774Qr169ar0BgEAAFyBwzNNjRo10sqVKyssf/311yulIQAAAFfk8EwTAABATeTwTBNQnTWZtOqyNYdmxl2DTgAAroaZJgAAAAsshaY9e/aY3zcHAABQE1kKTR06dNCPP/4oSWrWrJlOnDhRpU0BAAC4Gkuhyd/fX1lZWZKkQ4cOMesEAABqHEsXgg8YMEA9evRQSEiIbDabOnXqJHd394vW/uc//6nUBgEAAFyBpdC0aNEi9e/fXwcPHtRTTz2lkSNHysfHp6p7AwAAcBmWbzlQfrfv9PR0jR07ltAEAABqFIfv07R48WLz5x9++EGS+M45AABQ7Tl8n6aysjK98MIL8vPzU+PGjdW4cWP5+/vrxRdf5AJxAABQbTk80/Tcc8/p3Xff1cyZM9WtWzdJ0pYtW/T888/rzJkz+tOf/lTpTQIAADibw6Hp/fff1zvvvKP77rvPXBYREaEbb7xRTz75JKEJAABUSw6fnjt58qRatWpVYXmrVq108uTJSmkKAADA1Tgcmtq1a6f58+dXWD5//ny1a9euUpoCAABwNQ6fnps1a5bi4uK0du1aRUVFSZLS0tJ05MgRff7555XeIAAAgCtweKapR48e+ve//60HHnhA+fn5ys/PV//+/ZWRkaE777yzKnoEAABwOodnmiQpNDSUC74BAECN4vBMEwAAQE1EaAIAALCA0AQAAGCBQ6HJMAxlZ2frzJkzVdUPAACAS3I4NLVo0UJHjhypqn4AAABckkOhyc3NTTfffLNOnDhRVf0AAAC4JIevaZo5c6aeeeYZ7du3ryr6AQAAcEkO36fpkUce0enTp9WuXTt5eHjI29vbbpzvnwMAANWRw6Fpzpw5VdAGAACAa3M4NA0dOrQq+gAAAHBpV3SfpszMTE2ZMkWDBw/WsWPHJElffPGF9u/fX6nNAQAAuAqHQ9OmTZsUHh6u7du369NPP1VRUZEk6ZtvvtH06dMrvUEAAABX4HBomjRpkl566SWlpqbKw8PDXH7PPfdo27ZtldocAACAq3A4NO3du1cPPPBAheWBgYH68ccfK6UpAAAAV+NwaPL391dOTk6F5V9//bVuvPHGSmkKAADA1TgcmgYNGqSJEycqNzdXNptNZWVl+vLLLzVhwgQ98sgjVdEjAACA0zkcml5++WW1atVKYWFhKioqUps2bdS9e3fdfvvtmjJlSlX0CAAA4HQO36fJw8NDb7/9tqZOnap9+/apqKhIHTp00M0331wV/QEAALgEh0NTuUaNGiksLEySZLPZKq0hAAAAV3RFN7d899131bZtW3l5ecnLy0tt27bVO++8U9m9AQAAuAyHZ5qmTZum1157TWPGjFFUVJQkKS0tTePHj1d2drZeeOGFSm8SAADA2RwOTQsWLNDbb7+twYMHm8vuu+8+RUREaMyYMYQmAABQLTl8eq6kpESdOnWqsLxjx446f/58pTQFAADgahwOTUOGDNGCBQsqLF+0aJHi4+MrpSkAAABXY+n0XGJiovmzzWbTO++8ozVr1qhr166SpO3btys7O5ubWwIAgGrL0kzT119/bT727t2rjh07qmHDhsrMzFRmZqYaNGig2267Tfv373fozTdv3qy+ffsqNDRUNptNK1assBs3DEPTpk1TSEiIvL29FR0dre+//96u5uTJk4qPj5evr6/8/f01YsQIFRUV2dXs2bNHd955p7y8vBQWFqZZ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2oEDBzRjxgz95S9/UU5Ojnr37n1N3heA6+ILewHgIjIzMyVJ999/v2w2m5O7AeAKmGkCcNXOnj2rCRMm6MYbb9QNN9ygyMhIbdy40RxPTk6Wv7+/Vq9erdatW6tu3brq1auXcnJyzJrz58/rqaeekr+/v+rXr6+JEydq6NCh6tevnyTp0Ucf1aZNmzR37lzZbDbZbDYdOnTIfH16ero6deqkOnXq6Pbbb1dGRsYle967d6/uueceeXt7q379+ho1apSKiook/XJarm/fvpIkNze33wxNp06dUnx8vBo2bChvb2/dfPPNWrx4sTk+ceJE3XLLLapTp46aNWumqVOnqqSkxBx//vnn1b59e7333ntq1KiR6tatqyeffFKlpaWaNWuWgoODFRgYqD/96U9272uz2bRgwQL17t1b3t7eatasmT755JNLbu++ffvUu3dv1a1bV0FBQRoyZIh+/PFHc/yTTz5ReHi4uT+io6NVXFx8yXUCNQ2hCcBVGz16tNLS0vTRRx9pz549+v3vf69evXrp+++/N2tOnz6tP//5z/qf//kfbd68WdnZ2ZowYYI5/sorr+iDDz7Q4sWL9eWXX6qwsNDuOqK5c+cqKipKI0eOVE5OjnJychQWFmaOP/fcc5o9e7a++uor1apVS8OHD//NfouLixUbG6t69epp586dWrZsmdauXavRo0dLkiZMmGCGn/L3upipU6fq22+/1RdffKEDBw5owYIFatCggTnu4+Oj5ORkffvtt5o7d67efvttvf7663bryMzM1BdffKGUlBR9+OGHevfddxUXF6cffvhBmzZt0iuvvKIpU6Zo+/btFd57wIAB+uabbxQfH69BgwbpwIEDF+0zPz9f99xzjzp06KCvvvpKKSkpysvL00MPPWRu4+DBgzV8+HAdOHBAGzduVP/+/cX3uQO/YgCAg3r06GGMHTvWMAzDOHz4sOHu7m7897//tavp2bOnMXnyZMMwDGPx4sWGJOPgwYPm+JtvvmkEBQWZz4OCgoxXX33VfH7+/HmjUaNGxv3333/R9y23YcMGQ5Kxdu1ac9mqVasMScbPP/980f4XLVpk1KtXzygqKrJ7jZubm5Gbm2sYhmEsX77cuNyvyL59+xrDhg27ZM2FXn31VaNjx47m8+nTpxt16tQxCgsLzWWxsbFGkyZNjNLSUnNZy5YtjaSkJPO5JOPxxx+3W3dkZKTxxBNPGIZhGFlZWYYk4+uvvzYMwzBefPFFIyYmxq7+yJEjhiQjIyPDSE9PNyQZhw4dsrwtQE3ENU0ArsrevXtVWlqqW265xW752bNnVb9+ffN5nTp11Lx5c/N5SEiIjh07JkkqKChQXl6eunTpYo67u7urY8eOKisrs9RHRESE3bol6dixY2rUqFGF2gMHDqhdu3a64YYbzGXdunVTWVmZMjIyFBQUZOk9n3jiCQ0YMEC7du1STEyM+vXrp9tvv90cX7p0qebNm6fMzEwVFRXp/Pnz8vX1tVtHkyZN5OPjYz4PCgqSu7u73Nzc7JaV76tyUVFRFZ7/1qflvvnmG23YsEF169atMJaZmamYmBj17NlT4eHhio2NVUxMjB588EHVq1fP0n4AagpCE4CrUlRUJHd3d6Wnp8vd3d1u7MI/0rVr17Ybs9lslXr658L1l1+DZDVwXanevXvr8OHD+vzzz5WamqqePXsqISFBf/7zn5WWlqb4+HjNmDFDsbGx8vPz00cffaTZs2f/Zt/lvV9s2dVsS1FRkfr27atXXnmlwlhISIjc3d2VmpqqrVu3as2aNXrjjTf03HPPafv27WratOkVvy9Q3XBNE4Cr0qFDB5WWlurYsWNq0aKF3SM4ONjSOvz8/BQUFKSdO3eay0pLS7Vr1y67Og8PD5WWll51z61bt9Y333xjd6Hzl19+KTc3N7Vs2dKhdTVs2FBDhw7V3/72N82ZM0eLFi2SJG3dulWNGzfWc889p06dOunmm2/W4cOHr7r3ctu2bavwvHXr1hetve2227R//341adKkwn+j8tk2m82mbt26acaMGfr666/l4eGh5cuXV1q/QHVAaAJwVW655RbFx8frkUce0aeffqqsrCzt2LFDSUlJWrVqleX1jBkzRklJSfrss8+UkZGhsWPH6tSpU3afXGvSpIm2b9+uQ4cO6ccff7zi2Zf4+Hh5eXlp6NCh2rdvnzZs2KAxY8ZoyJAhlk/NSdK0adP02Wef6eDBg9q/f79WrlxpBpebb75Z2dnZ+uijj5SZmal58+ZVaghZtmyZ3nvvPf373//W9OnTtWPHDvNC9l9LSEjQyZMnNXjwYO3cuVOZmZlavXq1hg0bptLSUm3fvl0vv/yyvvrqK2VnZ+vTTz/V8ePHfzOEATUVoQnAVVu8eLEeeeQRPf3002rZsqX69eunnTt3XvR6ot8yceJEDR48WI888oiioqJUt25dxcbGysvLy6yZMGGC3N3d1aZNGzVs2FDZ2dlX1G+dOnW0evVqnTx5Up07d9aDDz6onj17av78+Q6tx8PDQ5MnT1ZERIS6d+8ud3d3ffTRR5Kk++67T+PHj9fo0aPVvn17bd26VVOnTr2ifi9mxowZ+uijjxQREaG//vWv+vDDD9WmTZuL1oaGhurLL79UaWmpYmJiFB4ernHjxsnf319ubm7y9fXV5s2b1adPH91yyy2aMmWKZs+ezQ09gV+xGZV5UQEAVJKysjK1bt1aDz30kF588UVnt+NSbDabli9fbt7DCsC1wYXgAFzC4cOHtWbNGvXo0UNnz57V/PnzlZWVpYcfftjZrQGAJE7PAXARbm5uSk5OVufOndWtWzft3btXa9eu5boaAC6D03MAAAAWMNMEAABgAaEJAADAAkITAACABYQmAAAACwhNAAAAFhCaAAAALCA0AQAAWEBoAgAAsOD/AxhKWEd3hHbhAAAAAElFTkSuQmCC\n"},"metadata":{}},{"output_type":"stream","name":"stdout","text":["전체 샘플 중 길이가 64 이하인 샘플의 비율: 98.77442224725894\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2pCbTyqOj-Xn","outputId":"7285ce0a-d621-4ed3-9bef-c946b00bf5e8","executionInfo":{"status":"ok","timestamp":1716190254887,"user_tz":-540,"elapsed":3715,"user":{"displayName":"손정락","userId":"10892662232752168928"}},"cellView":"form"},"source":["#@title 토큰 인덱스 변환, 패딩 및 어텐션 마스크 세팅\n","\n","# 입력 토큰의 최대 시퀀스 길이\n","MAX_LEN = 최대길이\n","\n","## 입력 문장의 최대 길이를 지정해줍니다.\n","## 물론 어떤 리뷰는 128자 이상이기도 합니다. 하지만 효율성을 위해서 고정해줍니다.\n","## MAX_LEN을 256, 512 등 더 크게 변경할 수도 있습니다. 그러면 처리 시간이 더 걸립니다. 대신 정확도는 상승합니다.\n","## 반대로 MAX_LEN을 64, 32 등 더 작게 변경할 수도 있습니다. 그러면 처리 시간은 짦아지고, 정확도는 줄어듭니다.\n","## MAX_LEN에 \"정답\"은 없습니다. 적절한 길이를 선택해야 합니다.\n","\n","# 토큰을 숫자 인덱스로 변환\n","input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","# 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","## 패딩이란 MAX_LEN보다 짦은 문장에 적용합니다. 문장 길이가 120이라면 8개가 패딩으로 채워지게 됩니다.\n","input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","print(input_ids[0])\n","\n","# 어텐션 마스크 초기화\n","attention_masks = []\n","\n","# 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","# 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","for seq in input_ids:\n","    seq_mask = [float(i>0) for i in seq]\n","    attention_masks.append(seq_mask)\n","\n","print(attention_masks[0])"],"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["[   101   9627    117  71963    122  16323  10954   8985  35979    100\n","   9665   9670  25347    100   9851    100   9654 118940  71433 119199\n","  16985  37093   9485  18784    100    102      0      0      0      0\n","      0      0      0      0      0      0      0      0      0      0\n","      0      0      0      0      0      0      0      0      0      0\n","      0      0      0      0      0      0      0      0      0      0\n","      0      0      0      0]\n","[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4hv7e7J1kKFO","outputId":"3014b0b6-608a-44c0-c88c-90a1f12017a5","executionInfo":{"status":"ok","timestamp":1716190255875,"user_tz":-540,"elapsed":990,"user":{"displayName":"손정락","userId":"10892662232752168928"}},"cellView":"form"},"source":["#@title 훈련데이터와 검증 데이터 분리 및 배치 세팅\n","\n","검증데이터비율 = \"0.2\"  #@param ['0.1', '0.2', '0.3']\n","\n","배치크기 = \"64\"  #@param ['8', '16', '32', '64', '128', '256']\n","배치크기 = int(배치크기)\n","\n","\n","# 훈련셋과 검증셋으로 분리\n","validation_size = 검증데이터비율\n","## 훈련셋과 검증셋은 9:1로 분리해줍니다. 숫자를 변경하면 비율을 변경할 수 있습니다.\n","\n","random_state = 1\n","## 컴퓨터에서의 분리는 시간값을 토대로 하는 랜덤입니다.\n","## 하지만 완전히 랜덤으로 하면 학습마다 다른 결과가 나오는 문제가 발생합니다.\n","## 이를 통제하기 위해서 랜덤 시작값을 세팅해줍니다.\n","\n","train_inputs, validation_inputs, train_labels, validation_labels = train_test_split(input_ids,\n","                                                                                    labels,\n","                                                                                    random_state=random_state,\n","                                                                                    test_size=0.1)\n","\n","# 어텐션 마스크를 훈련셋과 검증셋으로 분리\n","train_masks, validation_masks, _, _ = train_test_split(attention_masks,\n","                                                       input_ids,\n","                                                       random_state=random_state,\n","                                                       test_size=0.1)\n","\n","# 데이터를 파이토치의 텐서로 변환\n","train_inputs = torch.tensor(train_inputs)\n","train_labels = torch.tensor(train_labels)\n","train_masks = torch.tensor(train_masks)\n","validation_inputs = torch.tensor(validation_inputs)\n","validation_labels = torch.tensor(validation_labels)\n","validation_masks = torch.tensor(validation_masks)\n","\n","print(\"##### 훈련 텍스트의 bert embedding값 #####\")\n","print(train_inputs[0])\n","print(\"##### 훈련 텍스트의 label 값 #####\")\n","print(train_labels[0])\n","print(\"##### 훈련 텍스트의 MASK값 = 패딩 여부 확인 #####\")\n","print(train_masks[0])\n","print(\"##### 검증 텍스트의 bert embedding값 #####\")\n","print(validation_inputs[0])\n","print(\"##### 검증 텍스트의 label 값 #####\")\n","print(validation_labels[0])\n","print(\"##### 검증 텍스트의 MASK값 = 패딩 여부 확인 #####\")\n","print(validation_masks[0])\n","\n","\n","# 배치 사이즈\n","batch_size = 배치크기\n","\n","# 파이토치의 DataLoader로 입력, 마스크, 라벨을 묶어 데이터 설정\n","# 학습시 배치 사이즈 만큼 데이터를 가져옴\n","train_data = TensorDataset(train_inputs, train_masks, train_labels)\n","train_sampler = RandomSampler(train_data)\n","train_dataloader = DataLoader(train_data, sampler=train_sampler, batch_size=batch_size)\n","\n","validation_data = TensorDataset(validation_inputs, validation_masks, validation_labels)\n","validation_sampler = SequentialSampler(validation_data)\n","validation_dataloader = DataLoader(validation_data, sampler=validation_sampler, batch_size=batch_size)"],"execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["##### 훈련 텍스트의 bert embedding값 #####\n","tensor([   101,    112,   9297,  13764,   9901,  18778,    112,   9987, 118792,\n","         10459,   8909,  36553,  10459, 119471,   9330,  30842,  18623,    107,\n","          9580, 118762,  83491,  19855,  14279,   9405, 119362,    107,    102,\n","             0,      0,      0,      0,      0,      0,      0,      0,      0,\n","             0,      0,      0,      0,      0,      0,      0,      0,      0,\n","             0,      0,      0,      0,      0,      0,      0,      0,      0,\n","             0,      0,      0,      0,      0,      0,      0,      0,      0,\n","             0])\n","##### 훈련 텍스트의 label 값 #####\n","tensor(0)\n","##### 훈련 텍스트의 MASK값 = 패딩 여부 확인 #####\n","tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,\n","        1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])\n","##### 검증 텍스트의 bert embedding값 #####\n","tensor([  101,   112,  9064, 68530,  8908, 14871,   112, 64749,  9568, 31605,\n","        10530,   112,  9627, 40958, 79604, 37824,   112,  9309, 37388,  9879,\n","        18392,  9379, 16617,  8982, 37093, 11903,   102,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0,     0,     0,     0,     0,     0,     0,\n","            0,     0,     0,     0])\n","##### 검증 텍스트의 label 값 #####\n","tensor(0)\n","##### 검증 텍스트의 MASK값 = 패딩 여부 확인 #####\n","tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,\n","        1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n","        0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])\n"]}]},{"cell_type":"code","metadata":{"id":"5PymQ8C8oWRO","cellView":"form","executionInfo":{"status":"ok","timestamp":1716190260322,"user_tz":-540,"elapsed":3170,"user":{"displayName":"손정락","userId":"10892662232752168928"}}},"source":["#@title 테스트 데이터 처리(훈련데이터와 동일)\n","\n","# 리뷰 문장 추출\n","sentences = test['text']\n","\n","# BERT의 입력 형식에 맞게 변환\n","sentences = [\"[CLS] \" + str(sentence) + \" [SEP]\" for sentence in sentences]\n","\n","# 라벨 추출\n","labels = test['label'].values\n","\n","# BERT의 토크나이저로 문장을 토큰으로 분리\n","tokenizer = BertTokenizer.from_pretrained(bert모델, do_lower_case=False)\n","tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","# 토큰을 숫자 인덱스로 변환\n","input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","# 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","input_ids = pad_sequences(input_ids, maxlen=최대길이, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","# 어텐션 마스크 초기화\n","attention_masks = []\n","\n","# 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","# 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","for seq in input_ids:\n","    seq_mask = [float(i>0) for i in seq]\n","    attention_masks.append(seq_mask)\n","\n","# 데이터를 파이토치의 텐서로 변환\n","test_inputs = torch.tensor(input_ids)\n","test_labels = torch.tensor(labels)\n","test_masks = torch.tensor(attention_masks)\n","\n","# 파이토치의 DataLoader로 입력, 마스크, 라벨을 묶어 데이터 설정\n","# 학습시 배치 사이즈 만큼 데이터를 가져옴\n","test_data = TensorDataset(test_inputs, test_masks, test_labels)\n","test_sampler = RandomSampler(test_data)\n","test_dataloader = DataLoader(test_data, sampler=test_sampler, batch_size=배치크기)"],"execution_count":11,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"rnSRKCfvpKN8"},"source":["## 모델 세팅"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"teKFL712pELo","outputId":"3936dd1a-92fe-46cc-cb63-d9ca77efb568","executionInfo":{"status":"ok","timestamp":1716190263923,"user_tz":-540,"elapsed":285,"user":{"displayName":"손정락","userId":"10892662232752168928"}},"cellView":"form"},"source":["#@title GPU 세팅\n","\n","## 해당 부분에서 에러가 나면, \"런타임 > 런타임 유형 변경 > 하드웨어 가속시 > GPU\"로 변경해야 합니다.\n","\n","# GPU 디바이스 이름 구함\n","device_name = tf.test.gpu_device_name()\n","\n","# GPU 디바이스 이름 검사\n","if device_name == '/device:GPU:0':\n","    print('Found GPU at: {}'.format(device_name))\n","else:\n","    raise SystemError('GPU device not found')\n","\n","# 디바이스 설정\n","if torch.cuda.is_available():\n","    device = torch.device(\"cuda\")\n","    print('There are %d GPU(s) available.' % torch.cuda.device_count())\n","    print('We will use the GPU:', torch.cuda.get_device_name(0))\n","else:\n","    device = torch.device(\"cpu\")\n","    print('No GPU available, using the CPU instead.')"],"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["Found GPU at: /device:GPU:0\n","There are 1 GPU(s) available.\n","We will use the GPU: Tesla T4\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":142,"referenced_widgets":["f34f68549e2f431cb8f6d1907045316a","72c249e3ac594fd5a0de32c75d515538","4d2a69a5888d46418129523da0cfa0e2","9eadf62e19b8408b858a45ea2e816712","a98d2f717a4d405ca3a4777959795a29","9a727696d7954071b6269a3a7c0aefd1","625a03389da84322a1d0f6dc299cc7be","65a80817ccfd42ec9bfc9c32f7241973","e6fdda2ffca94409939536c3fdfc3a20","edb2ff3404d74a4da9be3e144fe51732","c002411a8f364a8eaeddcf96e6852e71"]},"id":"dphPxgdcpRbA","outputId":"a5fd663e-e1fc-4e44-bf33-a05b588699ea","executionInfo":{"status":"ok","timestamp":1716190275337,"user_tz":-540,"elapsed":10148,"user":{"displayName":"손정락","userId":"10892662232752168928"}},"cellView":"form"},"source":["#@title 딥러닝 모델 세팅\n","\n","# 분류를 위한 BERT 모델 생성\n","## 이미 bert를 통한 분류 모델이 만들어져 있습니다. 모델을 불러오기만 하면 됩니다.\n","## num_labels를 통해서 분류 갯수를 지정해줍니다. 저희는 긍정-부정의 2개 분류이기에 2입니다.\n","\n","분류개수 = \"2\"  #@param ['2', '3', '4', '5']\n","분류개수 = int(분류개수)\n","\n","epochs수 = \"3\"  #@param ['2', '3', '4', '5']\n","epochs수 = int(epochs수)\n","\n","model = BertForSequenceClassification.from_pretrained(bert모델, num_labels=분류개수)\n","model.cuda()\n","\n","# 옵티마이저 설정\n","optimizer = AdamW(model.parameters(),\n","                  lr = 2e-5, # 학습률\n","                  eps = 1e-8 # 0으로 나누는 것을 방지하기 위한 epsilon 값\n","                )\n","\n","# 에폭수\n","epochs = epochs수\n","\n","# 총 훈련 스텝 : 배치반복 횟수 * 에폭\n","total_steps = len(train_dataloader) * epochs\n","\n","# 처음에 학습률을 조금씩 변화시키는 스케줄러 생성\n","scheduler = get_linear_schedule_with_warmup(optimizer,\n","                                            num_warmup_steps = 0,\n","                                            num_training_steps = total_steps)"],"execution_count":13,"outputs":[{"output_type":"display_data","data":{"text/plain":["model.safetensors:   0%|          | 0.00/714M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f34f68549e2f431cb8f6d1907045316a"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-multilingual-cased and are newly initialized: ['classifier.bias', 'classifier.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:521: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]}]},{"cell_type":"code","metadata":{"id":"T7JIBmmfYY63","executionInfo":{"status":"ok","timestamp":1716190275338,"user_tz":-540,"elapsed":6,"user":{"displayName":"손정락","userId":"10892662232752168928"}},"cellView":"form","colab":{"base_uri":"https://localhost:8080/"},"outputId":"cdcde469-4b54-4519-bfc3-5eb755520965"},"source":["#@title 딥러닝 모델 간략 보기\n","\n","# Get all of the model's parameters as a list of tuples.\n","params = list(model.named_parameters())\n","\n","print('The BERT model has {:} different named parameters.\\n'.format(len(params)))\n","\n","print('==== Embedding Layer ====\\n')\n","\n","for p in params[0:5]:\n","    print(\"{:<55} {:>12}\".format(p[0], str(tuple(p[1].size()))))\n","\n","print('\\n==== First Transformer ====\\n')\n","\n","for p in params[5:21]:\n","    print(\"{:<55} {:>12}\".format(p[0], str(tuple(p[1].size()))))\n","\n","print('\\n==== Output Layer ====\\n')\n","\n","for p in params[-4:]:\n","    print(\"{:<55} {:>12}\".format(p[0], str(tuple(p[1].size()))))"],"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["The BERT model has 201 different named parameters.\n","\n","==== Embedding Layer ====\n","\n","bert.embeddings.word_embeddings.weight                  (119547, 768)\n","bert.embeddings.position_embeddings.weight                (512, 768)\n","bert.embeddings.token_type_embeddings.weight                (2, 768)\n","bert.embeddings.LayerNorm.weight                              (768,)\n","bert.embeddings.LayerNorm.bias                                (768,)\n","\n","==== First Transformer ====\n","\n","bert.encoder.layer.0.attention.self.query.weight          (768, 768)\n","bert.encoder.layer.0.attention.self.query.bias                (768,)\n","bert.encoder.layer.0.attention.self.key.weight            (768, 768)\n","bert.encoder.layer.0.attention.self.key.bias                  (768,)\n","bert.encoder.layer.0.attention.self.value.weight          (768, 768)\n","bert.encoder.layer.0.attention.self.value.bias                (768,)\n","bert.encoder.layer.0.attention.output.dense.weight        (768, 768)\n","bert.encoder.layer.0.attention.output.dense.bias              (768,)\n","bert.encoder.layer.0.attention.output.LayerNorm.weight        (768,)\n","bert.encoder.layer.0.attention.output.LayerNorm.bias          (768,)\n","bert.encoder.layer.0.intermediate.dense.weight           (3072, 768)\n","bert.encoder.layer.0.intermediate.dense.bias                 (3072,)\n","bert.encoder.layer.0.output.dense.weight                 (768, 3072)\n","bert.encoder.layer.0.output.dense.bias                        (768,)\n","bert.encoder.layer.0.output.LayerNorm.weight                  (768,)\n","bert.encoder.layer.0.output.LayerNorm.bias                    (768,)\n","\n","==== Output Layer ====\n","\n","bert.pooler.dense.weight                                  (768, 768)\n","bert.pooler.dense.bias                                        (768,)\n","classifier.weight                                           (2, 768)\n","classifier.bias                                                 (2,)\n"]}]},{"cell_type":"markdown","metadata":{"id":"Q-ZqbqlZpwJF"},"source":["## 모델 학습"]},{"cell_type":"code","metadata":{"id":"ev0G_fZEpuol","colab":{"base_uri":"https://localhost:8080/"},"outputId":"21c43c22-bf09-49da-901b-b4b1ed3d5f63"},"source":["#@title 딥러닝 학습\n","\n","# 정확도 계산 함수\n","def flat_accuracy(preds, labels):\n","\n","    pred_flat = np.argmax(preds, axis=1).flatten()\n","    labels_flat = labels.flatten()\n","\n","    return np.sum(pred_flat == labels_flat) / len(labels_flat)\n","\n","# 시간 표시 함수\n","def format_time(elapsed):\n","\n","    # 반올림\n","    elapsed_rounded = int(round((elapsed)))\n","\n","    # hh:mm:ss으로 형태 변경\n","    return str(datetime.timedelta(seconds=elapsed_rounded))\n","\n","\n","## 본격적으로 딥러닝 학습을 수행하게 됩니다.\n","## 현재 150000개의 데이터로는 1 epoch 50분 정도의 시간이 소요됩니다.\n","## 4번의 epoch이기에 약 200분, 3시간이 넘는 학습 시간이 필요합니다.\n","## 연습을 하실 때에는 1000개 정도로 데이터량을 줄여서 테스트 해보실 것을 권장드립니다.\n","\n","from tqdm.notebook import tqdm\n","\n","# 재현을 위해 랜덤시드 고정\n","seed_val = 42\n","random.seed(seed_val)\n","np.random.seed(seed_val)\n","torch.manual_seed(seed_val)\n","torch.cuda.manual_seed_all(seed_val)\n","\n","# We'll store a number of quantities such as training and validation loss,\n","# validation accuracy, and timings.\n","training_stats = []\n","\n","# Measure the total training time for the whole run.\n","total_t0 = time.time()\n","\n","# 에폭만큼 반복\n","for epoch_i in range(0, epochs):\n","\n","    # ========================================\n","    #               Training\n","    # ========================================\n","\n","    print(\"\")\n","    print('======== Epoch {:} / {:} ========'.format(epoch_i + 1, epochs))\n","    print('Training...')\n","\n","    # 시작 시간 설정\n","    t0 = time.time()\n","\n","    # Reset the total loss for this epoch.\n","    total_train_loss = 0\n","\n","    # 훈련모드로 변경\n","    model.train()\n","\n","    # 데이터로더에서 배치만큼 반복하여 가져옴\n","    for step, batch in enumerate(train_dataloader):\n","        # 경과 정보 표시 / 매 40  batch 마다\n","        if step % 500 == 0 and not step == 0:\n","            elapsed = format_time(time.time() - t0)\n","            print('  Batch {:>5,}  of  {:>5,}.    Elapsed: {:}.'.format(step, len(train_dataloader), elapsed))\n","\n","        # Unpack this training batch from our dataloader.\n","        #\n","        # As we unpack the batch, we'll also copy each tensor to the GPU using the\n","        # `to` method.\n","        #\n","        # `batch` contains three pytorch tensors:\n","        #   [0]: input ids\n","        #   [1]: attention masks\n","        #   [2]: labels\n","        b_input_ids = batch[0].to(device)\n","        b_input_mask = batch[1].to(device)\n","        b_labels = batch[2].to(device)\n","\n","\n","        # 그래디언트 초기화\n","        model.zero_grad()\n","\n","        # Forward 수행\n","        # Perform a forward pass (evaluate the model on this training batch).\n","        # The documentation for this `model` function is here:\n","        # https://huggingface.co/transformers/v2.2.0/model_doc/bert.html#transformers.BertForSequenceClassification\n","        # It returns different numbers of parameters depending on what arguments\n","        # arge given and what flags are set. For our useage here, it returns\n","        # the loss (because we provided labels) and the \"logits\"--the model\n","        # outputs prior to activation.\n","        output = model(b_input_ids,\n","                             token_type_ids=None,\n","                             attention_mask=b_input_mask,\n","                             labels=b_labels)\n","\n","        # 총 로스 계산\n","        # Accumulate the training loss over all of the batches so that we can\n","        # calculate the average loss at the end. `loss` is a Tensor containing a\n","        # single value; the `.item()` function just returns the Python value\n","        # from the tensor.\n","        loss = output[0]\n","        total_train_loss += loss.item()\n","        logits = output[1]\n","\n","        # Backward 수행으로 그래디언트 계산\n","        # Perform a backward pass to calculate the gradients.\n","        loss.backward()\n","\n","        # 그래디언트 클리핑\n","        # Clip the norm of the gradients to 1.0.\n","        # This is to help prevent the \"exploding gradients\" problem.\n","        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n","\n","        # 그래디언트를 통해 가중치 파라미터 업데이트\n","        # Update parameters and take a step using the computed gradient.\n","        # The optimizer dictates the \"update rule\"--how the parameters are\n","        # modified based on their gradients, the learning rate, etc.\n","        optimizer.step()\n","\n","        # 스케줄러로 학습률 감소\n","        # Update the learning rate.\n","        scheduler.step()\n","\n","        # 그래디언트 초기화\n","        model.zero_grad()\n","\n","    # 평균 로스 계산\n","    # Calculate the average loss over all of the batches.\n","    avg_train_loss = total_train_loss  / len(train_dataloader)\n","\n","    # Measure how long this epoch took.\n","    training_time = format_time(time.time() - t0)\n","\n","    print(\"\")\n","    print(\"  Average training loss: {0:.2f}\".format(avg_train_loss))\n","    print(\"  Training epcoh took: {:}\".format(format_time(time.time() - t0)))\n","\n","    # ========================================\n","    #               Validation\n","    # ========================================\n","\n","    print(\"\")\n","    print(\"Running Validation...\")\n","\n","    #시작 시간 설정\n","    t0 = time.time()\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 변수 초기화\n","    # Tracking variables\n","    total_eval_accuracy = 0\n","    total_eval_loss = 0\n","    nb_eval_steps = 0\n","\n","    # 데이터로더에서 배치만큼 반복하여 가져옴\n","    for batch in validation_dataloader:\n","        # 배치를 GPU에 넣음\n","        b_input_ids = batch[0].to(device)\n","        b_input_mask = batch[1].to(device)\n","        b_labels = batch[2].to(device)\n","\n","        # 그래디언트 계산 안함\n","        with torch.no_grad():\n","            # Forward 수행\n","            output = model(b_input_ids,\n","                                   token_type_ids=None,\n","                                   attention_mask=b_input_mask,\n","                                   labels=b_labels)\n","\n","        # 로스 구함\n","        loss = output.loss\n","        total_eval_loss += loss.item()\n","        logits = output.logits\n","\n","        # CPU로 데이터 이동\n","        logits = logits.detach().cpu().numpy()\n","        label_ids = b_labels.to('cpu').numpy()\n","\n","        # 출력 로짓과 라벨을 비교하여 정확도 계산\n","        total_eval_accuracy += flat_accuracy(logits, label_ids)\n","\n","    # Report the final accuracy for this validation run.\n","    avg_val_accuracy = total_eval_accuracy / len(validation_dataloader)\n","    print(\"  Accuracy: {0:.2f}\".format(avg_val_accuracy))\n","\n","    # Calculate the average loss over all of the batches.\n","    avg_val_loss = total_eval_loss / len(validation_dataloader)\n","\n","    # Measure how long the validation run took.\n","    validation_time = format_time(time.time() - t0)\n","\n","    print(\"  Validation Loss: {0:.2f}\".format(avg_val_loss))\n","    print(\"  Validation took: {:}\".format(validation_time))\n","\n","    # Record all statistics from this epoch.\n","    training_stats.append(\n","        {\n","            'epoch': epoch_i + 1,\n","            'Training Loss': avg_train_loss,\n","            'Valid. Loss': avg_val_loss,\n","            'Training. Accur': avg_val_accuracy,\n","            'Valid. Accur.': avg_val_accuracy,\n","            'Training Time': training_time,\n","            'Validation Time': validation_time\n","        }\n","    )\n","\n","print(\"\")\n","print(\"Training complete!\")\n","\n","print(\"Total training took {:} (h:mm:ss)\".format(format_time(time.time()-total_t0)))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","======== Epoch 1 / 3 ========\n","Training...\n"]}]},{"cell_type":"code","metadata":{"id":"dZY-VW2TYkox","cellView":"form"},"source":["#@title 딥러닝 학습 간단 보기\n","\n","import pandas as pd\n","\n","# Display floats with two decimal places.\n","# pd.set_option('precision', 2)  # deprecated\n","pd.set_option(\"display.max_columns\", 100)\n","\n","# Create a DataFrame from our training statistics.\n","df_stats = pd.DataFrame(data=training_stats)\n","\n","# Use the 'epoch' as the row index.\n","df_stats = df_stats.set_index('epoch')\n","\n","# A hack to force the column headers to wrap.\n","#df = df.style.set_table_styles([dict(selector=\"th\",props=[('max-width', '70px')])])\n","\n","# Display the table.\n","print(df_stats.to_string())\n","\n","\n","import matplotlib.pyplot as plt\n","%matplotlib inline\n","\n","import seaborn as sns\n","\n","# Use plot styling from seaborn.\n","sns.set(style='darkgrid')\n","\n","# Increase the plot size and font size.\n","sns.set(font_scale=1.5)\n","plt.rcParams[\"figure.figsize\"] = (12,6)\n","\n","# Plot the learning curve.\n","plt.plot(df_stats['Training Loss'], 'b-o', label=\"Training\")\n","plt.plot(df_stats['Valid. Loss'], 'g-o', label=\"Validation\")\n","\n","# Label the plot.\n","plt.title(\"Training & Validation Loss\")\n","plt.xlabel(\"Epoch\")\n","plt.ylabel(\"Loss\")\n","plt.legend()\n","# plt.xticks([1, 2, 3, 4])\n","plt.xticks([i for i in range(1, epochs수+1)])\n","\n","plt.show()"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"5fWUafz0p6s7","colab":{"base_uri":"https://localhost:8080/","height":881},"cellView":"form","outputId":"dd296af2-f36a-41b3-c366-5e03cc0b0271","executionInfo":{"status":"ok","timestamp":1690959109011,"user_tz":-540,"elapsed":26565,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 학습 평가하기\n","\n","라벨링 = ['bosu','jinbo']  #@param\n","\n","\n","# import\n","import time\n","\n","#시작 시간 설정\n","t0 = time.time()\n","\n","# 평가모드로 변경\n","model.eval()\n","\n","\n","# Tracking variables\n","predictions , true_labels, predictionsfin = [], [], []\n","\n","# 변수 초기화\n","eval_loss, eval_accuracy = 0, 0\n","nb_eval_steps, nb_eval_examples = 0, 0\n","\n","# 데이터로더에서 배치만큼 반복하여 가져옴\n","for step, batch in enumerate(test_dataloader):\n","    # 경과 정보 표시\n","    if step % 100 == 0 and not step == 0:\n","        elapsed = format_time(time.time() - t0)\n","        print('  Batch {:>5,}  of  {:>5,}.    Elapsed: {:}.'.format(step, len(test_dataloader), elapsed))\n","\n","    # 배치를 GPU에 넣음\n","    batch = tuple(t.to(device) for t in batch)\n","\n","    # 배치에서 데이터 추출\n","    b_input_ids, b_input_mask, b_labels = batch\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","    label_ids = b_labels.to('cpu').numpy()\n","\n","    # Store predictions and true labels\n","    predictions.append(logits)\n","    true_labels.append(label_ids)\n","\n","    # 출력 로짓과 라벨을 비교하여 정확도 계산\n","    tmp_eval_accuracy = flat_accuracy(logits, label_ids)\n","    eval_accuracy += tmp_eval_accuracy\n","    nb_eval_steps += 1\n","\n","print(\"\")\n","print(\"##### 테스트 모델을 통한 모델 정확도 #####\")\n","print(\"Accuracy: {0:.2f}\".format(eval_accuracy/nb_eval_steps))\n","print(\"Test took: {:}\".format(format_time(time.time() - t0)))\n","\n","\n","## 테스트 데이터를 대상으로 하는 모델 상세 평가\n","## precision = 정밀도 = 실제로는 False이지만 True로 라벨링 한 것에 집중\n","## 실제로는 스팸메일이 아니지만 스펨 메일로 라벨링하면?!\n","## recall = 재현율 = 실제 True인데 False 라벨링한 것에 집중\n","## 실제로는 코로나 감염자이지만, 코로나 감염이 아니라고 하면?!\n","## F1 = 정밀도와 재현율의 조화평균\n","\n","rounded_labels_set = []\n","rounded_predictions_set = []\n","\n","from sklearn.metrics import classification_report\n","\n","# For each input batch...\n","for i in range(len(true_labels)):\n","\n","  # The predictions for this batch are a 2-column ndarray (one column for \"0\"\n","  # and one column for \"1\"). Pick the label with the highest value and turn this\n","  # in to a list of 0s and 1s.\n","  rounded_labels = np.argmax(predictions[i], axis=1).flatten()\n","  rounded_labels_set.extend(rounded_labels)\n","  # Calculate and store the coef for this batch.\n","  rounded_predictions = true_labels[i].flatten()\n","  rounded_predictions_set.extend(rounded_predictions)\n","\n","labels = 라벨링\n","\n","print(\"\")\n","print(classification_report(rounded_labels_set, rounded_predictions_set, target_names=labels))\n","print(\"\")\n","\n","\n","## 혼란 매트릭스 - Confusion matrix\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from sklearn.metrics import confusion_matrix\n","\n","\n","# For each input batch...\n","for i in range(len(true_labels)):\n","\n","  # The predictions for this batch are a 2-column ndarray (one column for \"0\"\n","  # and one column for \"1\"). Pick the label with the highest value and turn this\n","  # in to a list of 0s and 1s.\n","  rounded_labels = np.argmax(predictions[i], axis=1).flatten()\n","  rounded_labels_set.extend(rounded_labels)\n","  # Calculate and store the coef for this batch.\n","  rounded_predictions = true_labels[i].flatten()\n","  rounded_predictions_set.extend(rounded_predictions)\n","\n","from sklearn.metrics import confusion_matrix\n","cm = confusion_matrix(rounded_labels_set, rounded_predictions_set)\n","\n","def plot_confusion_matrix(\n","    ax, matrix, labels, title='Confusion matrix', fontsize=9):\n","\n","    ax.set_xticks([x for x in range(len(labels))])\n","    ax.set_yticks([y for y in range(len(labels))])\n","\n","    # Place labels on minor ticks\n","    ax.set_xticks([x + 0.5 for x in range(len(labels))], minor=True)\n","    ax.set_xticklabels(labels, rotation=90, fontsize=fontsize, minor=True)  # rotation must be num not str\n","    ax.set_yticks([y + 0.5 for y in range(len(labels))], minor=True)\n","    ax.set_yticklabels(labels[::-1], fontsize=fontsize, minor=True)\n","\n","    # Hide major tick labels\n","    ax.tick_params(which='major', labelbottom='off', labelleft='off')\n","\n","    # Finally, hide minor tick marks\n","    ax.tick_params(which='minor', width=0)\n","\n","    # Plot heat map\n","    proportions = [1. * row / sum(row) for row in matrix]\n","    ax.pcolor(np.array(proportions[::-1]), cmap=plt.cm.Reds)\n","\n","    # Plot counts as text\n","    for row in range(len(matrix)):\n","        for col in range(len(matrix[row])):\n","            confusion = matrix[::-1][row][col]\n","            if confusion != 0:\n","                ax.text(col + 0.5, row + 0.5, int(confusion),\n","                        fontsize=fontsize,\n","                        horizontalalignment='center',\n","                        verticalalignment='center')\n","\n","    # Add finishing touches\n","    ax.grid(True, linestyle=':')\n","    ax.set_title(title, fontsize=fontsize)\n","    ax.set_xlabel('prediction', fontsize=fontsize)\n","    ax.set_ylabel('actual', fontsize=fontsize)\n","\n","    plt.show()\n","\n","\n","if __name__ == '__main__':\n","    matrix = cm\n","    labels = 라벨링\n","\n","    fig, ax = plt.subplots(figsize=(6, 6))\n","\n","    plot_confusion_matrix(ax, matrix, labels, fontsize=10)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["  Batch   100  of    127.    Elapsed: 0:00:20.\n","\n","##### 테스트 모델을 통한 모델 정확도 #####\n","Accuracy: 0.78\n","Test took: 0:00:26\n","\n","              precision    recall  f1-score   support\n","\n","        bosu       0.84      0.82      0.83      5235\n","       jinbo       0.68      0.72      0.70      2882\n","\n","    accuracy                           0.78      8117\n","   macro avg       0.76      0.77      0.76      8117\n","weighted avg       0.78      0.78      0.78      8117\n","\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 600x600 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAiQAAAI1CAYAAADmeeFOAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAAA5GElEQVR4nO3df3zO9f7H8ee1379nM2yTNjY2hfn9K+SMIupwiiRNKSQphySSX9Mi6ddRcqiI0glfJJ1DUSoVR2HCkN9mzM9tbPbzur5/TNdp5sfM7L3Z4367ud12fa739blel9Ph4fP5XNdlsdlsNgEAABjkYHoAAAAAggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggRAibDZbBo7dqyaN2+uiIgIJSQkXPc+o6OjNXfu3OsfrhyIiIjQ6tWrTY8BGGPho+OBm9uJEyc0c+ZMrV27VsnJyapcubLq1q2rRx99VK1atSqx5/nuu+/09NNPa968eapRo4b8/Pzk5OR0Xfs8ffq03N3d5e7uXkJTlp4NGzaob9++2rhxo3x8fK66/sSJE/L19ZWLi0spTAeUPdf3pwWAMi0xMVG9e/eWj4+PRo4cqTp16ig3N1fr1q3TxIkTtXLlyhJ7rsOHD6tKlSpq3Lhxie3T39+/xPZVVmVnZ8vFxUVVqlQxPQpgFKdsgJvYxIkTZbFYtGjRInXq1Ek1a9ZU7dq11a9fPy1cuNC+LikpSU899ZQaNWqkxo0ba+jQoTp58qT9/unTp6tbt25atmyZoqOj1aRJEw0bNkznzp2TJI0aNUqTJk1SUlKSIiIiFB0dLenSp1y6deum6dOnS8o/zTN9+nS1b99e9erVU5s2bfTyyy/b1178+Oud81KWLFmipk2b6ttvv1WnTp0UFRWlZ599VufPn9fSpUsVHR2tZs2a6eWXX1ZeXp79ccuWLdP999+vRo0a6Y477tBzzz2nU6dOScoPwb59+0qSmjVrpoiICI0aNUqSFBMTo9jYWMXFxalFixZ64oknJBU8ZbNs2TI1atRIBw4csD/fhAkT1LlzZ50/f/6yrwUozwgS4CaVkpKiH374QX369JGHh0eh+/84jWC1WjV48GClpqZq/vz5mjNnjg4fPqxhw4YVWH/o0CGtWbNGM2fO1D//+U9t3LhRs2fPliSNGTNGzz77rAIDA7Vu3TotXry4SDOuWrVKc+fO1cSJE/XVV19pxowZqlOnziXXlsScl5OZman58+frzTff1Pvvv68NGzZoyJAh+u677zRr1ixNnTpV//rXv7Rq1Sr7Y3JzczV06FAtX75c7777ro4cOWKPjqCgIHt0rVy5UuvWrdOYMWPsj126dKmcnZ316aefauLEiYXm6d69u9q1a6cRI0YoNzdXa9eu1eLFizVt2rRyefoKKApO2QA3qUOHDslms6lWrVpXXPfzzz9r9+7dWrNmjYKCgiRJU6dOVdeuXbV161Y1aNBAUv7RjMmTJ8vLy0uS9Ne//lU///yzhg0bJm9vb3l6esrR0fGaTj0cPXpUAQEBat26tZydnRUcHGx/vhsx5+Xk5ORowoQJuvXWWyVJnTp10vLly/Xjjz/K09NT4eHhatGihdavX68uXbpIknr06GF/fI0aNTRmzBj16NFD6enp8vT0lK+vrySpcuXKha4hCQ0N1ciRI6/4exMbG6u//vWvevnll/X1119ryJAhqlev3hUfA5RnHCEBblJFvV597969CgwMtP8lL0nh4eHy8fHRvn377NuqV69u/0tekqpWrWo/RVFcnTt3VlZWljp27KiXXnpJX3/9tXJzc0t9Tnd3d3uMSFJAQICqV68uT0/PAttOnz5tv71t2zYNGjRI7du3V6NGjRQTEyMpP7Ku5vbbb7/qGl9fX8XFxenTTz9VjRo1NHDgwKs+BijPCBLgJhUSEiKLxVLgL+vrcal3zFwteiwWS6Ftfw6OoKAgrVy5UuPHj5ebm5smTpyoRx55RDk5OaU658WPsVgsl9xmtVolSRkZGXriiSfk6empadOmafHixXrnnXckqUizF/W0y8aNG+Xo6KgTJ04oIyOjSI8ByiuCBLhJVapUSW3atNEnn3xyyb/M0tLSJElhYWE6duxYgX/Z79mzR2lpaQoLC7uuGfz9/XX8+HH77XPnzikxMbHAGjc3N0VHR+ull17SvHnztHnzZu3evbvQvm7knNdq3759SklJ0YgRI9S0aVOFhYUVOgrj7OwsSQUuhL0WmzZt0vvvv6/33ntPHh4emjRp0nXPDZRlBAlwExs/frysVqt69uypVatW6cCBA9q7d6/mzZunXr16SZJat26tOnXqaMSIEdq+fbu2bt2qkSNHqnnz5qpfv/51PX/Lli21fPly/fLLL9q1a5deeOEFOTj874+dJUuWaNGiRdq9e7cOHz6s5cuXy83NTcHBwYX2dSPnvFbBwcFydnbW/PnzdfjwYa1Zs0YzZswosKZ69eqyWCxau3atTp8+rfT09CLv/9y5cxo5cqRiYmJ05513atq0afr3v/9dom/TBsoaggS4idWoUUNLlixRixYt9Oqrr+ree+9Vv3799PPPP2vChAmS8k9FzJgxQz4+PnrkkUf02GOPqUaNGnrzzTev+/mffPJJNWvWTE8++aSefPJJdezYscC1Gj4+Plq0aJF69+5tv/h05syZ8vPzK7SvGznntfL399eUKVO0cuVKdenSRbNnz9YLL7xQYE21atX0zDPP6PXXX1fr1q2v6QhHXFyc3N3dNXz4cEn5bwkePny4xo8fr+Tk5BJ9LUBZwSe1AgAA4zhCAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOP4tt8iysvJ0enDiVdfCKDUVQkNMT0CgMuxWPJ/XQVBUkSnDydqbFiU6TEAXMLM9MOmRwBwOW7eRQoSTtkAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHEECQAAMI4gAQAAxhEkAADAOIIEAAAYR5AAAADjCBIAAGAcQQIAAIwjSAAAgHFOpgeIiYlRZGSkxowZY3oUlCM2SfsreynZx13Zjo5yyc1TUNp5hZw+J8uFNQnVfHXM16PA4/zTMxV15Iz99s81qyjTueD/DWqdSFPImfRCz5nh7KhfQgJksUlt9yaX9EsCbhobf92kD+Z9rG07durEyZN6942p6viX9vb7T546pWlvv6N1P2/Q2XNn1bRxI40dOUKhIbfa13z2f0u14j+rtH3nLqWnp2vj92vk4+1d6LnW/rBO7876QLt+3yNXFxc1a9JIM96cVgqvEiXNeJAAxXHQ31NJlTwVeSxFnlm5OuvmrJ2BvnKyWnVLSoZ9nX96piKPpdpvO9hshfZV8+RZBaX+7zFO1sJrrJJ2BFWS7/lspbm5lOyLAW4yGeczFVGnth7odp+GPPdCgftsNpueHva8nJycNOOtafLy9NTcjxeo36Ah+nLJZ/Jwd5cknc/MVNvWrdS2dSu9Pv3dSz7PqtXfaOykVzRsyFNq2byp8nLztHvv3hv++nBjECQol9LcXBRwLlMB6VmSJPdzeTqe7nYhFv4XFw42yTXPesV9OVqtV12zP8BbHtm58ssgSICrubNNa93ZpvUl7ztw6JC2/LZNKxZ/qtphYZKkCS++oDs63qMv/7NKPe/vLkl6rE9vSdKGX3695H5yc3MV99obev7vz6jn37rZt4eH1SrBV4LSVCauIcnLy1NsbKyaNGmiFi1a6K233pLtwr9kU1NTNXLkSDVr1kxRUVHq37+/Dhw4YH/skSNHNGjQIDVr1kwNGzZU165d9d1330mSlixZoqZNmxZ4rtWrVysiIqLUXhtuDJ/MbJ3xcFGGs6Mk6ZyLk1LcXeSfnllgXYq7i9bVqqr1oVW0q6qPchwshfZ1yN9LP4RV08ZbA3TIz1MXp8kZdxcd93JTneNpN+rlABVGdnaOJMnVxdW+zcHBQS4uzvp1S3yR97Nj5y4lHz8uBwcHdX/oEbW56x71f3qodu/hCEl5VSaCZOnSpXJ0dNSiRYs0ZswYzZ07V4sWLZIkjRo1Stu2bdN7772nzz77TDabTQMHDlROTv5/1LGxscrOztbHH3+sL774QiNGjJCHh8eVng43gZDT6ap6NlMbQqtobe1AbQwJUI0z6Qo8+78g8c/IUt1jKWqYeFphJ9KU4u6i+Fv89ecTMtXPZOi2oylqdPiUglMzdNDfS3ur/O88dY6DRQmBlVQ3OfWSp3IAXJtaoaEKDgzU69PfVWpamrJzcjRrzkc6lnxcJ06eLPJ+DicekSS9M3O2nur/uGa+/YZ8fbwVM2CQUlJTr/JolEVl4pRNUFCQXnzxRVksFtWqVUu7d+/W3Llz1bx5c33zzTf69NNP1bhxY0nStGnT1L59e61evVr33HOPkpKS1KlTJ/tRjxo1aph8KSglx73dlOztrtsuXENyztVZv1f1kUueVUFp5yVJ1f4UJ17ZufLKztX6mlV1xt1F/uezJUm3pqQXWONgs2lXNV+FnTwrB5u0s1olVTt7XpUurAdwfZydnTT99Vc1ZuLLan5nRzk6OqpVi2Zqd0dr+5HxorDa8o9lDurfT506RkuSJk8cp3ad7tXKr9fooR7335D5ceOUiSCJioqSxfK/Q+kNGzbUnDlztGfPHjk5OSkqKsp+n5+fn2rWrKm9Fy5c6tu3ryZMmKB169apdevWuvvuuxUZGVnqrwGla2+Aj249fc4eHV7Zucp0dtQhfy97kFzMPSdPzrl5Ou/iJF0mMHwyc2SzWJTp5CiPnDyleLjolIOrDvt5Ssp/d48sFq2tHaiI5NTLPheAy6t3W119/tknOnv2nHJycuTv76eeMf1U77a6Rd5HlYAASVJYrZr2bS4uLqpxS3UdPXasxGfGjVcmTtlcj549e2r16tXq1q2bdu/erR49emj+/PmS8s9LXlzcf5zqQfmW52DRxVeDWGw2XenfV5lODspxdJBrbt5l15x1dZJsNjlfuMi18eFTanrwpP1XzVPn5JhnVdODJxVwLvOy+wFwdd7eXvL399OBg4e0bUeCOrRvV+TH1qsbKRcXF+0/cNC+LScnV0eSjio4KOhGjIsbrEwcIdm6dWuB2/Hx8QoJCVF4eLhyc3MVHx9vP2Vz5swZ7d+/X+Hh4fb1QUFB6t27t3r37q3XX39dCxcuVExMjPz8/JSenq6MjAz7dSU7d+4svReGGybgXKYO+nvJNTcv/5SNm5MO+3naj1jkWiw6UNlLVc5lyiXXqvPOjtpbxUfuOXnyz8h/Z06qm7PS3Jzll5EtR5tNqW7O2lPFR4Fp5+V84XoRz+zcAs97NjdPFuUfkQFwaekZGTp0ONF+O/FIkhJ27Zavj4+CgwL1n69Xy9/PT8GBgdr1+x698tob6tj+TrVp1dL+mBMnT+rkqdM6dOiwJGn373vk6empoMBqquTrKy8vLz3U435NnzlbQYHVFBwUpA8+yv/HaOe7OpTuC0aJKBNBkpSUpMmTJ6tXr17asWOHPv74Y73wwgsKDQ1Vhw4dNHbsWE2cOFFeXl6aNm2aqlWrpg4d8v+Di4uLU7t27RQaGqq0tDRt2LBBYRfeShYVFSV3d3e98cYb6tu3r+Lj47VkyRKTLxUlpPbxNO0P8Nbuqj7KufDBaMGpGQo9dU6SZJFN51yddczHXbkXjor4pWer1qn8a0Ok/M8kOe7trgOVvWW1WOSWk6saZ9JVI6Xwh6IBKLptOxLUd8BT9tuTX39LkvS3+7pqSux4nThxSlNef0unTp1WlYAAdbu3iwYPfKLAPv61eIne+ef79tt9nngyf18Tx+n+v94rSRr592fl5OiokS9NUGZWlqLq3a6PZr0rXx+fG/wKcSNYbNdyFdENEBMTo/DwcFmtVq1YsUKOjo7q3bu3/v73v8tisSg1NVVxcXH65ptvlJOTo6ZNm2rs2LEKDQ2VJE2aNEnff/+9jh07Ji8vL7Vt21ajR4+Wn5+fpPy3+U6dOlXJyclq1aqVoqOjNXbsWO3ateua5jyxb7/GhkVdfSGAUjcz/bDpEQBcjpu35HD1K0SMB0l5QZAAZRdBApRhRQyScn9RKwAAKP8IEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOMIEgAAYBxBAgAAjHMq6sIhQ4YUeafvvPNOsYYBAAAVU5GDxNvb+0bOAQAAKrAiB8nkyZNv5BwAAKAC4xoSAABgXJGPkFxs5cqV+s9//qOjR48qJyenwH1Lly697sEAAEDFUawjJPPmzdPo0aMVEBCgHTt2qH79+qpUqZIOHz6sdu3alfSMAADgJlesIyQLFizQpEmTdO+992rJkiUaMGCAatSoobffflupqaklPSMAALjJFesIydGjR9WoUSNJkpubm9LT0yVJ3bp105dfflly0wEAgAqhWEESEBBgPxISFBSkLVu2SJISExNls9lKbDgAAFAxFOuUTcuWLfXNN9/otttu0wMPPKDJkydr1apV2rZtm+66666SnhEAANzkLLZiHNKwWq2yWq1ycsrvmS+//FKbN29WSEiIevXqJRcXlxIf9EpOnDihH3/8Udu2bdNvv/2mhIQEZWVlqXnz5po/f37JPMe+/RobFlUi+wJQsmamHzY9AoDLcfOWHK5+QqZYR0gcHBzk8Kedd+3aVV27di3OrkrEl19+yQe3AQBQjhUrSDZu3HjF+5s1a1asYYrLy8tLrVu3Vv369VW/fn3t2LFDM2bMKNUZAABA8RUrSGJiYgpts1gs9p8TEhKKP1Ex9OjRQz169LDfTk5OLtXnBwAA16dEjpDk5OQoISFBb7/9toYNG1YigwEAgIqjWEFyqW/+veOOO+Ts7KwpU6ZoyZIl1z0YAACoOEr0y/UqV66s/fv3l+QuAQBABVCsIyQ7d+4stO348eOaPXu2IiMjr3soAABQsRQrSLp37y6LxVLoU1kbNmyouLi4EhkMAABUHMUKkjVr1hS47eDgIH9/f7m6upbIUGVRwC1BmpGwyvQYAC5h2S0RpkcAcBl3bdogz9CQq64r1jUkGzduVJUqVVS9enVVr15dQUFBcnV1VXZ2tpYtW1acXQIAgAqsWEEyevRonT17ttD29PR0jR49+rqHAgAAFUuxgsRmsxX4ILQ/JCcnX/ItwQAAAFdyTdeQ/HExq8Vi0aOPPmr/cj1JysvLU2Jiotq2bVviQwIAgJvbNQVJx44dJeV/NHybNm3k6elpv8/Z2VnVq1fX3XffXbITAgCAm941BcmQIUMkSdWrV1fXrl3l4uJyQ4a6VkePHlX37t3tt7OzsyVJmzZtUosWLezb+/fvrwEDBpT2eAAA4CqK9bbfsLAwJSQkKCoqqsD2+Ph4OTg4qH79+iUyXFHl5eUpJSWl0Pbc3NwC2zMzM0tvKAAAUGTFCpLY2Fj179+/UJAkJydr9uzZWrRoUYkMV1S33HKLdu3aVarPCQAASk6x3mWzd+9e3X777YW2161bV3v27LnuoQAAQMVSrCBxcXHRyZMnC20/ceJEgXfeAAAAFEWxguSOO+7QG2+8UeDD0dLS0vTmm2+qdevWJTYcAACoGIp1OOOFF15Qnz599Je//EV169aVlP8NwJUrV9bUqVNLdEAAAHDzK1aQVKtWTcuXL9cXX3yhnTt3ys3NTQ888IC6du0qZ2fnkp4RAADc5Ip9wYeHh4eaNGmioKAg5eTkSJK+//57SVKHDh1KZjoAAFAhFCtIDh8+rKefflq7d++WxWIp9N02CQkJJTYgAAC4+RXrota4uDjdcsst+umnn+Tm5qYVK1Zo/vz5qlevnubPn1/SMwIAgJtcsYJk8+bNevbZZ+Xv7y8HBwc5ODioadOmGj58uF5++eWSnhEAANzkihUkVqvV/sV6fn5+On78uKT877jZv39/yU0HAAAqhGJdQ1K7dm3t2rVLNWrUUFRUlN5//305Oztr4cKFqlGjRknPCAAAbnLFOkLy1FNPyWq1SpKeffZZJSYmqk+fPvruu+80ZsyYEh0QAADc/Ip1hKRt27b2n0NCQrRy5UqlpKTI19e3wLttAAAAiqLEvnimUqVKJbUrAABQwRTrlA0AAEBJIkgAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGOdk8slHjRqltLQ0zZgxQzExMYqMjNSYMWOK9NjExER16NBBy5YtU926dW/wpChrNm7fpQ+X/lvb9xzUiTMpmj76GXVs2aTAmr2Hk/T6Rwu1cfsu5eXlKaxGdb09aoiCq1SWJI2fMVc/x2/X8dMp8nBzU6PIcD33aE/VuiW4wH6WrvlBcz9fpQNJx+Tl4a5OrZtp3KC+pfZagfLuW3dXrfRy0x0ZWfpreqYkaYObs7a4uuiIk6OyHCyacDJV7rb/Pea0g0VrPNy018VJZx0s8rFa1SgzR9EZWQX+4trl7KSvPV2V7OgoZ9lUMydPXc+dl7/VJpQvRoNkzJgxstny/6OZPn26nJyMjoNy5HxmliJCb9X9Hdrp2SnTC91/6Ohx9Rkdpwc6ttOQh/8mL3d37Tl0RK7OzvY1t4eF6t47Wyk4wF8p59L17qfL1H/8NH09a5ocHfMPHs79fKXmLFup5x/rpQZ1wnQ+K0tHkk+W2usEyrvDTo7a4O6ioNy8AtuzLRbVyc5VnexcrfRyK/S4E46Oslmk+8+eV+W8PCU7Oer/vN2VbbHo3gtRc9rBonm+Hmp7Pku9084r00H6wtNd8308NTTlXKm8PpQcowXg7e1t/7lSpUrmBkG5065JA7Vr0uCy97/18WK1a9JAzz/Wy77t1qCqBdY82Km9/efq1apo6CMPqPvQsTpy/KRuDaqq1HPpevvjJZrx0t/VKuo2+9qI0Bol90KAm1iWpH95u+uBsxn6xqNgdLQ9ny1J2uvseMnHRuTkKiIn1367cnauTmRkab27qz1IEp0cZZV0d3pW/vUHVqnd+SzN8/FQnqRL7xllldFrSEaNGqXBgwdLkmJiYhQXF2e/Lzo6WjNnztTo0aPVqFEjtW/fXp999lmhfezbt08PPfSQ6tevr3vvvVf//e9/C9z/3//+Vz169FC9evXUpk0bTZs2Tbm5uYX2g5uH1WrVd79sVWhwoPqPn6Y7+j6jXiNitXr9r5d9TEZmlpas/kG3VKuiwAB/SdJPW7bLarMq+dQZdX16tNo/PkzDpr6roydOldZLAcq1Zd7uiszOVe2cvKsvLoJMi0XuVqv99i25ebJI+sXNWVZJ5y3SJldnhefkEiPlUJm+qHXOnDmqV6+eli1bpocfflgTJkzQvn37CqyZOnWq+vXrp2XLlqlhw4YaNGiQzpw5I0lKTk7WwIEDVb9+fX3++eeaMGGCFi9erPfee8/Ey0EpOZWapozMTL3/f1+qTeP6en/CCHVs2VjPTnlH/922s8DaBf9eoya9nlSTXk/qh01b9cHE5+XinH/gMPHYcdlsNs1a/IVGP/Gw3nrhaaWcTdcT419Tdg5RC1zJFldnJTk5qvOFoxnX66SDg350d1WLzGz7Nn+rTf1T07XK001jAnw0IcBXqY4O6pOWUSLPidJVpoOkXbt26tOnj0JCQjRgwAD5+flpw4YNBdb06dNHnTp1UlhYmCZMmCBvb28tXrxYkrRgwQIFBgZq3LhxCgsLU8eOHfXMM8/oww8/lPVPlY2bi+3CxWzRLRrrsW6dVLdWiAb0uFftm0bps5XfFlh7352t9H9vTtS8V0YrNDhQw157V1nZ+X/gWW025eTmacyAR9SmcX01jAjX6yMG6eDRZP33t4RSf11AeZHiYNEXXm56KC1DzldfflWpDhZ9WMlDDbJy1CIzx779rMWi//NyV5PMHA1JOacnU87JySZ97OMpLmktf8r0VaQRERH2ny0WiwICAnTqVMHD5Y0aNbL/7OTkpHr16tmPouzdu1eNGjWSxWKxr2nSpIkyMjJ07NgxBQcXfDcFbg6VfLzl5OiosBoF//etVSNYm3bsLrDN29ND3p4eCg0OVFSdMLXsM1ir129S13YtVcWvkiQV2I+/r4/8vL2VdJLTNsDlHHFy1DkHB/3Dz8u+zWqxaL+zo352d1HcybQi/2s4zcGiWb6eCsnJ0/3nzhe47yd3F7nZbOryp6Mwvc5maHJlHx1yclRIbsmcKkLpKNNBcvG7biwWi/1dOcDluDg7qV54Te0/crTA9gNHjim4asAVHmmTzSZl5+T/C6xR3dqSpP1HjtmvK0k5e05nzp5V9SpX2g9QsYXn5GrY6bMFti3ydleVPKvaZ2QVOUZSL8RI9dw89Tx7vtDjciwWWS7a9sca/qYof8r0KZui2LJli/3n3Nxcbd++XbVq1ZIkhYWFafPmzQUi5tdff5Wnp6cCAwNLe1SUoPTzmUrYd1AJ+w5KkhKTTyph30ElXbjg9PG/3aOV6/6rhV+t1cGjyfrky9Vau3GLet8TLUk6fOy4Zi1eoe17DijpxCltTvhdf3/1Xbm6OqtdkyhJUs3qgerQopFeef8TbU74XbsPJmr027NVs3qQmtePNPPCgXLA1SYF5lkL/HKxSR5WmwLz8k+Xn7VYlOTooFMX3mJ/zMlRSY4OyrhwRDvVwaJ/+nqqktWmrumZSrdYdPbCrz9EZuco0clRqz1cddLRQUecHLTI211+eVZV5+hIuVOmj5AUxYIFCxQaGqpatWrpo48+Umpqqh544AFJ0sMPP6yPPvpIkyZNUp8+fbR//35Nnz5d/fr1k4NDuW+xCm37nv169KVX7bdf/fBTSVL36Ds0eegA3dWqicY/9ahmLf5Sr8z+RDWrB+rtUUPU5LY6kiRXZ2f9smO35i3/Smnp6ars66umt9fRp1NeUuVKPvb9Tvn7QE3+YIEGTXpTFgeLmt0eqdnjn5Mzn5kDXJf17i5a7fm/twLPrJR/eqdnWoaaZuXod2cnnXJy1ClJr1T2KfDYV0+kSpLCc/L00Nnz+s7dVd95uMrZZlNITp4eT00vkWtXULrK/Z+qzz33nGbNmqWEhASFhITovffek79//uH1atWqadasWZo6daoWLlyoSpUqqUePHnrqqacMT43r1bx+XSV8PveKax7o2E4PdGx3yfuqVvbTrHHDr/o8Xh7uinvmCcU980RxxgRwwZOp6QVu35WRpbsysi67vmlWjppeCI8raZiVo4ZZOVddh7LPYjN4Ucbw4cPl4OCgadOmmRqhyGzZmbLt22x6DACXsLz130yPAOAy7tq0QZ6hIVddZ+S8RW5urvbs2aMtW7aodu3aJkYAAABliJEg+f333/XAAw8oPDxcDz30kIkRAABAGWLkGpK6desqPj7exFMDAIAyiLeaAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgHEECAACMI0gAAIBxBAkAADCOIAEAAMYRJAAAwDiCBAAAGEeQAAAA4wgSAABgnJPpAUrS+vXrNWfOHMXHxysjI0PBwcHq3LmzBg4cKA8PD9PjAQCAy7hpjpDMnz9fjz32mNauXStXV1eFhYXpyJEjeu+999SjRw+lpKSYHhEAAFzGTREk27Zt0yuvvCJJio2N1dq1a7V06VKtXr1at99+u/bu3auxY8canhIAAFzOTREkM2bMkNVqVbdu3dSrVy9ZLBZJUrVq1fTGG2/IwcFBX331lXbu3Gl4UgAAcCnlPkjS09P1ww8/SJIefPDBQveHhoaqZcuWkqSVK1eW6mwAAKBoyn2QJCQkKDs7Wy4uLmrQoMEl1zRp0kSSFB8fX5qjAQCAIir3QbJ//35JUnBwsJydnS+55tZbby2wFgAAlC3l/m2/qampkiRfX9/Lrvnjvj/WFouziyy1GhX/8QBumLs2bTA9AoDLcK8eXKR15T5IsrKyJOmyR0ckycXFpcDa4rBYHCQXt2I/HsCN4xkaYnoEANep3J+ycXV1lSTl5ORcdk12dnaBtQAAoGwp90FSlNMxRTmtAwAAzCn3QRIaGipJSkpKuuxRkkOHDhVYCwAAypZyHyR169aVs7OzsrOztXXr1kuu+fXXXyVJDRs2LMXJAABAUZX7IPHy8lKbNm0kSQsXLix0/4EDB7R+/XpJUufOnUt1NgAAUDTlPkgkafDgwbJYLPr888/12WefyWazSZKOHz+u4cOHy2q1qmPHjoqMjDQ8KQAAuBSL7Y+/vcu5uXPnasqUKbLZbAoKCpKfn5/27Nmj7Oxs1axZUwsWLJC/v7/pMQEAwCXcNEEiST///LM+/PBDbd26VRkZGQoODlbnzp01cOBAeXp6mh4PAABcxk0VJAAAoHy6Ka4hAQAA5RtBAgAAjCNIAABlwrFjx3Ts2DHTY8CQcv/legCA8stqtWrGjBmaM2eOMjIyJEmenp7q16+fnnrqKTk48O/mioIgAQAY8+abb2rx4sV67rnn1LhxY0n5n679zjvvKDs7W8OGDTM8IUoL77K5gvXr12vOnDmKj48v9DZiDw8P0+PhGkRGRspisVz2/oSEhFKcBtfrxIkT+vHHH7Vt2zb99ttvSkhIUFZWlpo3b6758+ebHg/XoE2bNpo4caI6dOhQYPvq1as1ceJE/fDDD4YmQ2njCMllzJ8/X3FxcbLZbAoMDFRQUJD27Nmj9957T1999ZUWLFigSpUqmR4TRfTOO+8UuJ2bm6uEhAQtXbpUzzzzjKGpUFxffvmlJk+ebHoMlIDU1FTVqlWr0PZatWpd8VvccfMhSC5h27ZteuWVVyRJsbGxevDBB2WxWJScnKynnnpK27dv19ixYzV9+nTDk6KoOnbsWGhb586dFR4ern//+9/q2bOngalQXF5eXmrdurXq16+v+vXra8eOHZoxY4bpsVAMkZGR+uSTT/TSSy8V2P7JJ5/wdR8VDEFyCTNmzJDValX37t3Vq1cv+/Zq1arpjTfe0D333KOvvvpKO3fu5P8w5VzDhg01btw402PgGvXo0UM9evSw305OTjY4Da7H888/ryeffFI//fST/RvZt2zZoqNHj2r27Nlmh0Op4vLli6Snp9vPWT744IOF7g8NDVXLli0lSStXrizV2VCyMjMzNW/ePFWtWtX0KECF1bx5c61cuVJ33XWXzp49q7Nnz+quu+7SypUr1bRpU9PjoRRxhOQiCQkJys7OlouLixo0aHDJNU2aNNFPP/2k+Pj4Up4OxdWsWbMCF7XabDalp6fLzc1Nr732msHJAFSrVo1304Agudj+/fslScHBwXJ2dr7kmltvvbXAWpR9o0ePLhAkFotF/v7+ioqKkq+vr8HJAKSmpmrx4sXau3evJCk8PFz3338/bxyoYAiSi/xxVfeV/pL64z6uAC8/7r//ftMjALiEjRs3atCgQfL29la9evUk5b/L8d1339XMmTPVrFkzwxOitBAkF8nKypKkyx4dkSQXF5cCa1H2ff/99/Lw8LCfk/7kk0+0cOFChYeHa9y4cRwlAQyJjY1Vly5dNGHCBDk6OkqS8vLyNHHiRMXGxuqLL74wPCFKCxe1XsTV1VWSlJOTc9k12dnZBdai7HvttdeUnp4uSdq1a5cmT56sO++8U4mJiZoyZYrh6YCK6+DBg+rXr589RiTJ0dFRjz32mA4ePGhwMpQ2jpBcpCinY4pyWgdlS2JiosLCwiRJX331laKjozV8+HBt375dAwcONDwdUHHddttt2rdvX6EPR9u3bx8fq1DBECQXCQ0NlSQlJSUpJyfnkqduDh06VGAtyj5nZ2dlZmZKkn766Sd1795dUn5Unjt3zuBkQMWzc+dO+899+/ZVXFycDh48qKioKElSfHy8PvnkE40YMcLUiDCAILlI3bp15ezsrOzsbG3dulVNmjQptObXX3+VJPuH+KDsa9y4sSZPnqzGjRvrt99+01tvvSVJOnDggAIDA80OB1Qw3bt3l8Vi0Z+/Su1Sb79/7rnn1KVLl9IcDQYRJBfx8vJSmzZt9O2332rhwoWFguTAgQNav369pPyPHkf5MG7cOE2cOFGrVq3S+PHjVa1aNUn5F7u2bdvW8HRAxbJmzRrTI6AMIkguYfDgwVq7dq0+//xzNW7c2P5dNsePH9fw4cNltVrVsWNHzm+WI8HBwfrnP/9ZaPuLL75oYBqgYqtevbrpEVAGWWx/PmYGu7lz52rKlCmy2WwKCgqSn5+f9uzZo+zsbNWsWVMLFiyQv7+/6TFxDfLy8rR69Wr7hy/Vrl1b0dHRBa7uR/lw9OhR+3VAUv473zIyMuTk5CQvLy/79v79+2vAgAEGJsS1OHDggDZs2KBTp07JarUWuG/IkCGGpkJp4wjJZTz22GOKiIjQhx9+qK1bt+rUqVMKDg5W586dNXDgQHl6epoeEdfg4MGDGjhwoJKTk1WzZk1J0qxZsxQYGKhZs2bZP30X5UNeXp5SUlIKbc/NzS2w/Y8LmVF2LVy4UBMmTJCfn58CAgIKfaIyQVJxcIQEFcKAAQNks9k0bdo0+8dRnzlzRs8//7wcHBw0a9YsswMCFdRf/vIX9e7dm7ffgw9GQ8WwceNGPf/88wW+G8PPz08jRozQxo0bzQ0GVHCpqam65557TI+BMoAgQYXg4uJi/6TWP0tPT7/i1wQAuLE6d+6sdevWmR4DZQDXkKBCaN++vcaNG6e4uDg1aNBAUv6HL02YMEHR0dGGpwMqrpCQEL399tuKj49XnTp15ORU8K+lvn37GpoMpY1rSFAhpKWl6YUXXtC3335r/wMvNzdXHTp00JQpU+Tt7W14QqBiutI/CCwWC59ZUoEQJKhQDh48qD179kiSwsPDFRISYngiAIDEKRtUIIsWLdJHH32kAwcOSMr/LqJHH31UPXv2NDsYAIAgQcXw9ttva+7cuXrkkUfs30G0ZcsWvfLKK0pKStLQoUPNDghUIJMnT9bQoUPl4eGhyZMnX3Ht6NGjS2kqmEaQoEL49NNPNWnSJN177732bR06dFBERIQmTZpEkAClaMeOHcrNzbX/DEgECSqI3Nxc1atXr9D222+/XXl5eQYmAiqu+fPnX/JnVGwECSqEbt266dNPPy10+HfhwoW67777DE0FVExDhgzRlClT5OXlddWPhvfw8FB4eLh69+7Nu+FucgQJblp/PjdtsVi0aNEi/fjjj4qKipIkbd26VUlJSQW+pA3AjffnsLhaZGRnZ+tf//qXNm3apJkzZ97o0WAQb/vFTSsmJqZI6ywWi+bNm3eDpwFQXHv27FGPHj20ZcsW06PgBiJIAABlWl5enn7//XdFRkaaHgU3EEECAACM48v1AACAcQQJAAAwjiABAADGESQAyo3o6GjNnTvXfjsiIkKrV6++rn2WxD4AXD8+hwRAubVu3Tr5+voWae306dO1evVqff7558XeB4AbhyABUKqys7Pl4uJSIvuqUqVKmdgHgOvHKRsA1yUmJkaxsbGKjY1VkyZN1KJFC7311lv64xMFoqOj9e6772rkyJFq3Lixxo0bJ0n65Zdf9PDDD6tBgwa688479fLLLysjI8O+31OnTmnQoEFq0KCBoqOjtXz58kLPffHplmPHjmn48OFq3ry5GjZsqPvvv1/x8fFasmSJ3nnnHe3cuVMRERGKiIjQkiVLLrmPXbt2qW/fvmrQoIFatGihsWPHKj093X7/qFGjNHjwYH3wwQdq06aNWrRooYkTJyonJ6dkf2OBCoYgAXDdli5dKkdHRy1atEhjxozR3LlztWjRIvv9H374oSIjI7Vs2TINHjxYhw4d0oABA3T33Xdr+fLlevPNN/Xrr79q0qRJ9seMGjVKR48e1bx58/SPf/xDCxYs0KlTpy47Q3p6uh555BElJydrxowZ+vzzz9W/f39ZrVZ16dJFjz/+uGrXrq1169Zp3bp16tKlS6F9ZGRk6IknnpCvr68WL16st956Sz/99FOBuSRpw4YNOnTokD766CNNmTJFS5cu1dKlS0vgdxKouDhlA+C6BQUF6cUXX5TFYlGtWrW0e/duzZ07Vw8++KAkqWXLlnr88cft68eMGaP77rtPjz32mCQpNDRUY8aMUUxMjCZMmKCkpCR9//33WrRokRo0aCBJiouLu2RE/GHFihU6ffq0Fi9erEqVKkmSQkJC7Pd7eHjI0dHxiqdoVqxYoezsbL366qvy8PCQJI0bN06DBg3SiBEjFBAQIEny9fXVuHHj5OjoqLCwMN155536+eef7a8XwLUjSABct6ioKFksFvvthg0bas6cOcrLy5Mk1atXr8D6nTt3ateuXfriiy/s22w2m6xWqxITE7V//345OTkVeFxYWJh8fHwuO0NCQoJuu+02e4wUx969exUREWGPEUlq3LixrFar9u/fbw+S8PBwOTo62tdUqVJFu3fvLvbzAiBIAJQCd3f3ArczMjL00EMPXfILEIOCgrR///5rfg43N7diz3etnJwK/tFpsVjEt3AA14drSABct61btxa4HR8fr5CQkAJHEf7stttu0549exQSElLol4uLi2rVqqXc3Fxt27bN/ph9+/YpLS3tsjNEREQoISFBKSkpl7zf2dlZVqv1iq8jLCxMu3btKnBx7aZNm+Tg4KCaNWte8bEArg9BAuC6JSUlafLkydq3b59WrFihjz/+WH379r3s+gEDBmjz5s2KjY1VQkKCDhw4oNWrVys2NlaSVKtWLbVt21bjx49XfHy8tm3bppdeeumKR0G6du2qgIAAPf300/r11191+PBhrVq1Sps3b5YkVa9eXYmJiUpISNDp06eVnZ1daB/33XefXFxcNGrUKO3evVvr16/XpEmT1K1bN/vpGgA3BkEC4Lp1795dmZmZ6tmzp2JjY9W3b1/16tXrsusjIyM1f/58HThwQA8//LD+9re/6R//+IeqVq1qXzN58mRVrVpVjzzyiJ555hk9+OCDqly58mX36eLiog8//FCVK1fWwIEDdd9992nWrFn2ozSdOnVS27Zt1bdvX7Vq1UorVqwotA93d3d98MEHSklJUY8ePTR06FC1atVKY8eOvY7fHQBFYbFx4hPAdYiJiVFkZKTGjBljehQA5RhHSAAAgHEECQAAMI5TNgAAwDiOkAAAAOMIEgAAYBxBAgAAjCNIAACAcQQJAAAwjiABAADGESQAAMA4ggQAABhHkAAAAOP+H6lQN+WwXkqsAAAAAElFTkSuQmCC\n"},"metadata":{}}]},{"cell_type":"markdown","metadata":{"id":"486mAnBJqGaV"},"source":["## 예측 모델 실전 테스트#"]},{"cell_type":"code","metadata":{"id":"I7fKoce5qD1I","colab":{"base_uri":"https://localhost:8080/"},"cellView":"form","outputId":"c15c9a12-21e3-40ee-cb21-a6a5cfecb677","executionInfo":{"status":"ok","timestamp":1690959109012,"user_tz":-540,"elapsed":23,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 모델로 예측하기\n","\n","\n","테스트용텍스트 = '\\u5C39\\uC774 \\uC5F4\\uCC3D\\uD55C \\uB178\\uB798, \\uBC14\\uC774\\uB4E0\\uC774 \\uC8FD\\uC740 \\uC7A5\\uB0A8\\uACFC \\uC990\\uACA8 \\uBD88\\uB800\\uB358 \\uACE1\\uC774\\uC5C8\\uB2E4'  #@param {type: \"string\"}\n","\n","# 입력 데이터 변환\n","def convert_input_data(sentences):\n","\n","    # BERT의 토크나이저로 문장을 토큰으로 분리\n","    tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","    # 입력 토큰의 최대 시퀀스 길이\n","    MAX_LEN = 128\n","\n","    # 토큰을 숫자 인덱스로 변환\n","    input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","    # 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","    input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","    # 어텐션 마스크 초기화\n","    attention_masks = []\n","\n","    # 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","    # 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","    for seq in input_ids:\n","        seq_mask = [float(i>0) for i in seq]\n","        attention_masks.append(seq_mask)\n","\n","    # 데이터를 파이토치의 텐서로 변환\n","    inputs = torch.tensor(input_ids)\n","    masks = torch.tensor(attention_masks)\n","\n","    return inputs, masks\n","\n","# 문장 테스트\n","def test_sentences(sentences):\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 문장을 입력 데이터로 변환\n","    inputs, masks = convert_input_data(sentences)\n","\n","    # 데이터를 GPU에 넣음\n","    b_input_ids = inputs.to(device)\n","    b_input_mask = masks.to(device)\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","\n","    return logits\n","\n","logits = test_sentences([테스트용텍스트])\n","\n","print(logits)\n","print(np.argmax(logits))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 2.3737793 -2.0936546]]\n","0\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"cellView":"form","outputId":"44e05921-9d2b-4a25-ca62-106d41a0d9e5","id":"-5ct2uxyx9zS","executionInfo":{"status":"ok","timestamp":1690959109012,"user_tz":-540,"elapsed":19,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 모델로 예측하기\n","\n","\n","테스트용텍스트 = '\\uBBF8\\uAD6D \\uAE30\\uC790 \\u201C\\uB3C4\\uCCAD \\uC7AC\\uBC1C\\uBC29\\uC9C0 \\uC57D\\uC18D \\uBC1B\\uC558\\uB098?\\u201D \\uC724 \\u201C\\uC2DC\\uAC04\\uC744 \\uB450\\uACE0\\u2026\\u201D'  #@param {type: \"string\"}\n","\n","# 입력 데이터 변환\n","def convert_input_data(sentences):\n","\n","    # BERT의 토크나이저로 문장을 토큰으로 분리\n","    tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","    # 입력 토큰의 최대 시퀀스 길이\n","    MAX_LEN = 128\n","\n","    # 토큰을 숫자 인덱스로 변환\n","    input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","    # 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","    input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","    # 어텐션 마스크 초기화\n","    attention_masks = []\n","\n","    # 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","    # 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","    for seq in input_ids:\n","        seq_mask = [float(i>0) for i in seq]\n","        attention_masks.append(seq_mask)\n","\n","    # 데이터를 파이토치의 텐서로 변환\n","    inputs = torch.tensor(input_ids)\n","    masks = torch.tensor(attention_masks)\n","\n","    return inputs, masks\n","\n","# 문장 테스트\n","def test_sentences(sentences):\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 문장을 입력 데이터로 변환\n","    inputs, masks = convert_input_data(sentences)\n","\n","    # 데이터를 GPU에 넣음\n","    b_input_ids = inputs.to(device)\n","    b_input_mask = masks.to(device)\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","\n","    return logits\n","\n","logits = test_sentences([테스트용텍스트])\n","\n","print(logits)\n","print(np.argmax(logits))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[[-2.2595198  1.8148196]]\n","1\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"cellView":"form","id":"Nrw22pQgdFaf","outputId":"1ec97a59-6f65-42a3-ffb1-eaaccf8c205e","executionInfo":{"status":"ok","timestamp":1690959109012,"user_tz":-540,"elapsed":17,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 모델로 예측하기\n","\n","\n","테스트용텍스트 = '\\uC6CC\\uC2F1\\uD134 \\uC120\\uC5B8 \\uB098\\uC628 \\uB0A0... \\u6587 \\u201C\\uD310\\uBB38\\uC810 \\uC120\\uC5B8\\uC740 \\uD3C9\\uD654 \\uC774\\uC815\\uD45C, \\uD55C\\uBC18\\uB3C4\\uC815\\uC138 \\uC545\\uD654\\u201D'  #@param {type: \"string\"}\n","\n","# 입력 데이터 변환\n","def convert_input_data(sentences):\n","\n","    # BERT의 토크나이저로 문장을 토큰으로 분리\n","    tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","    # 입력 토큰의 최대 시퀀스 길이\n","    MAX_LEN = 128\n","\n","    # 토큰을 숫자 인덱스로 변환\n","    input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","    # 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","    input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","    # 어텐션 마스크 초기화\n","    attention_masks = []\n","\n","    # 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","    # 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","    for seq in input_ids:\n","        seq_mask = [float(i>0) for i in seq]\n","        attention_masks.append(seq_mask)\n","\n","    # 데이터를 파이토치의 텐서로 변환\n","    inputs = torch.tensor(input_ids)\n","    masks = torch.tensor(attention_masks)\n","\n","    return inputs, masks\n","\n","# 문장 테스트\n","def test_sentences(sentences):\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 문장을 입력 데이터로 변환\n","    inputs, masks = convert_input_data(sentences)\n","\n","    # 데이터를 GPU에 넣음\n","    b_input_ids = inputs.to(device)\n","    b_input_mask = masks.to(device)\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","\n","    return logits\n","\n","logits = test_sentences([테스트용텍스트])\n","\n","print(logits)\n","print(np.argmax(logits))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 0.6921252  -0.73301876]]\n","0\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"cellView":"form","id":"SBmtihnPwIyb","outputId":"56fae0c6-fed1-4a51-fac8-193a0c38c13c","executionInfo":{"status":"ok","timestamp":1690959109013,"user_tz":-540,"elapsed":16,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 모델로 예측하기\n","\n","\n","테스트용텍스트 = '\\uAC04\\uD638\\uBC95 \\uAD6D\\uD68C \\uD1B5\\uACFC\\u2026\\uAD6D\\uD798\\uC740 \\u2018\\uAC04\\uD638\\uC0AC \\uCD9C\\uC2E0\\u2019 \\uCD5C\\uC5F0\\uC219\\uB9CC \\uCC2C\\uC131'  #@param {type: \"string\"}\n","\n","# 입력 데이터 변환\n","def convert_input_data(sentences):\n","\n","    # BERT의 토크나이저로 문장을 토큰으로 분리\n","    tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","    # 입력 토큰의 최대 시퀀스 길이\n","    MAX_LEN = 128\n","\n","    # 토큰을 숫자 인덱스로 변환\n","    input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","    # 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","    input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","    # 어텐션 마스크 초기화\n","    attention_masks = []\n","\n","    # 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","    # 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","    for seq in input_ids:\n","        seq_mask = [float(i>0) for i in seq]\n","        attention_masks.append(seq_mask)\n","\n","    # 데이터를 파이토치의 텐서로 변환\n","    inputs = torch.tensor(input_ids)\n","    masks = torch.tensor(attention_masks)\n","\n","    return inputs, masks\n","\n","# 문장 테스트\n","def test_sentences(sentences):\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 문장을 입력 데이터로 변환\n","    inputs, masks = convert_input_data(sentences)\n","\n","    # 데이터를 GPU에 넣음\n","    b_input_ids = inputs.to(device)\n","    b_input_mask = masks.to(device)\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","\n","    return logits\n","\n","logits = test_sentences([테스트용텍스트])\n","\n","print(logits)\n","print(np.argmax(logits))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[[-0.2462739   0.12010659]]\n","1\n"]}]},{"cell_type":"markdown","metadata":{"id":"BFp8z2KH5THp"},"source":["## 딥러닝 모델의 저장 & 불러오기"]},{"cell_type":"code","metadata":{"id":"clG08PlBNb2t","colab":{"base_uri":"https://localhost:8080/"},"outputId":"d9922234-3a16-423c-b159-3a32ad52868b","executionInfo":{"status":"ok","timestamp":1690959150617,"user_tz":-540,"elapsed":33419,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 모델 저장하기\n","\n","model.save_pretrained('.')\n","\n","## 딥러닝 모델 저장하기\n","from google.colab import drive\n","drive.mount(\"/content/drive\", force_remount=True)\n","\n","!cp \"/content/pytorch_model.bin\" -r \"/content/drive/MyDrive\"\n","!cp \"/content/config.json\" -r \"/content/drive/MyDrive\"\n"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"markdown","metadata":{"id":"Z-kVsanpCY4v"},"source":["### 딥러닝 모델 불러오기"]},{"cell_type":"code","source":["#@title 데이터 불러오기 - 모델 불러오기\n","\n","# 문서 ID로 실제 파일 불러오는 법\n","# pytorch_model.bin 링크 기입\n","## https://drive.google.com/file/d/1WlA1H9zlXyYFqrW0Yt1MsYKhCoW1ss8t/\n","파일ID = '1WlA1H9zlXyYFqrW0Yt1MsYKhCoW1ss8t'\n","파일저장이름 = 'pytorch_model.bin'\n","\n","!wget --load-cookies ~/cookies.txt \"https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies ~/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id={파일ID}' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\\1\\n/p')&id={파일ID}\" -O {파일저장이름} && rm -rf ~/cookies.txt\n","\n","\n","# config.json 링크 기입\n","## https://drive.google.com/file/d/1tus80Qm7dUDK-Mut_kEknxFCYZTWmCMy/\n","파일ID = '1tus80Qm7dUDK-Mut_kEknxFCYZTWmCMy'\n","파일저장이름 = 'config.json'\n","\n","!wget --load-cookies ~/cookies.txt \"https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies ~/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id={파일ID}' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\\1\\n/p')&id={파일ID}\" -O {파일저장이름} && rm -rf ~/cookies.txt\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wBczDDx9QfcZ","executionInfo":{"status":"ok","timestamp":1690959448946,"user_tz":-540,"elapsed":6912,"user":{"displayName":"지해인","userId":"10118119697182884789"}},"outputId":"16e2de5e-cedc-49c0-b571-ce315d319c05","collapsed":true},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["--2023-08-02 06:57:21--  https://docs.google.com/uc?export=download&confirm=t&id=1WlA1H9zlXyYFqrW0Yt1MsYKhCoW1ss8t\n","Resolving docs.google.com (docs.google.com)... 108.177.126.113, 108.177.126.102, 108.177.126.138, ...\n","Connecting to docs.google.com (docs.google.com)|108.177.126.113|:443... connected.\n","HTTP request sent, awaiting response... 303 See Other\n","Location: https://doc-0g-50-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/s44ghm0jh838e59khiig5encjucgv1q2/1690959375000/10118119697182884789/*/1WlA1H9zlXyYFqrW0Yt1MsYKhCoW1ss8t?e=download&uuid=d118a864-832b-4df8-ba57-46a1fbf92280 [following]\n","Warning: wildcards not supported in HTTP.\n","--2023-08-02 06:57:21--  https://doc-0g-50-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/s44ghm0jh838e59khiig5encjucgv1q2/1690959375000/10118119697182884789/*/1WlA1H9zlXyYFqrW0Yt1MsYKhCoW1ss8t?e=download&uuid=d118a864-832b-4df8-ba57-46a1fbf92280\n","Resolving doc-0g-50-docs.googleusercontent.com (doc-0g-50-docs.googleusercontent.com)... 108.177.119.132, 2a00:1450:4013:c00::84\n","Connecting to doc-0g-50-docs.googleusercontent.com (doc-0g-50-docs.googleusercontent.com)|108.177.119.132|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 711488305 (679M) [application/x-zip]\n","Saving to: ‘pytorch_model.bin’\n","\n","pytorch_model.bin   100%[===================>] 678.53M   131MB/s    in 4.5s    \n","\n","2023-08-02 06:57:26 (151 MB/s) - ‘pytorch_model.bin’ saved [711488305/711488305]\n","\n","--2023-08-02 06:57:27--  https://docs.google.com/uc?export=download&confirm=&id=1tus80Qm7dUDK-Mut_kEknxFCYZTWmCMy\n","Resolving docs.google.com (docs.google.com)... 108.177.126.113, 108.177.126.102, 108.177.126.138, ...\n","Connecting to docs.google.com (docs.google.com)|108.177.126.113|:443... connected.\n","HTTP request sent, awaiting response... 303 See Other\n","Location: https://doc-10-50-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/5ts0euefm1bilk6tprrne7gbhposds3a/1690959375000/10118119697182884789/*/1tus80Qm7dUDK-Mut_kEknxFCYZTWmCMy?e=download&uuid=a3d74bb3-3434-4654-a979-ab43d4f0286c [following]\n","Warning: wildcards not supported in HTTP.\n","--2023-08-02 06:57:27--  https://doc-10-50-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/5ts0euefm1bilk6tprrne7gbhposds3a/1690959375000/10118119697182884789/*/1tus80Qm7dUDK-Mut_kEknxFCYZTWmCMy?e=download&uuid=a3d74bb3-3434-4654-a979-ab43d4f0286c\n","Resolving doc-10-50-docs.googleusercontent.com (doc-10-50-docs.googleusercontent.com)... 108.177.119.132, 2a00:1450:4013:c00::84\n","Connecting to doc-10-50-docs.googleusercontent.com (doc-10-50-docs.googleusercontent.com)|108.177.119.132|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 895 [application/json]\n","Saving to: ‘config.json’\n","\n","config.json         100%[===================>]     895  --.-KB/s    in 0s      \n","\n","2023-08-02 06:57:27 (42.8 MB/s) - ‘config.json’ saved [895/895]\n","\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rGSfS8RLt0KH","outputId":"0535926b-9925-47fe-f965-bc46c6a0cafd","executionInfo":{"status":"ok","timestamp":1690959497874,"user_tz":-540,"elapsed":45351,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 불러온 모델을 위한 환경 세팅\n","\n","bert모델 = \"bert-base-multilingual-cased\"  #@param ['bert-base-multilingual-cased', 'bert-large-cased', 'bert-base-chinese']\n","\n","\n","# Hugging Face의 트랜스포머 모델을 설치\n","!pip install transformers\n","\n","import sys\n","\n","from IPython.display import clear_output\n","clear_output(wait=True)\n","\n","import tensorflow as tf\n","import torch\n","from torch.utils.data import TensorDataset, DataLoader, RandomSampler, SequentialSampler\n","\n","from transformers import BertTokenizer\n","from transformers import BertForSequenceClassification, AdamW, BertConfig\n","# from keras.preprocessing.sequence import pad_sequences  # path removed\n","from keras.utils import pad_sequences\n","import numpy as np\n","\n","\n","## 해당 부분에서 에러가 나면, \"런타임 > 런타임 유형 변경 > 하드웨어 가속시 > GPU\"로 변경해야 합니다.\n","\n","# GPU 디바이스 이름 구함\n","device_name = tf.test.gpu_device_name()\n","\n","# GPU 디바이스 이름 검사\n","if device_name == '/device:GPU:0':\n","    print('Found GPU at: {}'.format(device_name))\n","else:\n","    raise SystemError('GPU device not found')\n","\n","# 디바이스 설정\n","if torch.cuda.is_available():\n","    device = torch.device(\"cuda\")\n","    print('There are %d GPU(s) available.' % torch.cuda.device_count())\n","    print('We will use the GPU:', torch.cuda.get_device_name(0))\n","else:\n","    device = torch.device(\"cpu\")\n","    print('No GPU available, using the CPU instead.')\n","\n","\n","tokenizer = BertTokenizer.from_pretrained(bert모델, do_lower_case=False)\n","\n","#model_fn = 'pytorch_model.bin'\n","#bert_model = 'bert-base-multilingual-cased'\n","#model_state_dict = torch.load(model_fn)\n","#model = BertForSequenceClassification.from_pretrained(bert_model, state_dict = model_state_dict, num_labels = 2)\n","#model.bert.load_state_dict(model.bert.state_dict())\n","\n","model = BertForSequenceClassification.from_pretrained(\".\", num_labels=2)\n","model.cuda()\n","\n","\n","clear_output()\n","\n","print('환경 설정이 완료되었습니다.')"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["환경 설정이 완료되었습니다.\n"]}]},{"cell_type":"code","metadata":{"id":"5r0FESMaRgYM","colab":{"base_uri":"https://localhost:8080/"},"outputId":"f2de6567-3343-40ec-c714-315f5a7d1988","executionInfo":{"status":"ok","timestamp":1690959498817,"user_tz":-540,"elapsed":945,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 모델로 예측하기\n","\n","\n","테스트용텍스트 = '\\u5C39\\uC774 \\uC5F4\\uCC3D\\uD55C \\uB178\\uB798, \\uBC14\\uC774\\uB4E0\\uC774 \\uC8FD\\uC740 \\uC7A5\\uB0A8\\uACFC \\uC990\\uACA8 \\uBD88\\uB800\\uB358 \\uACE1\\uC774\\uC5C8\\uB2E4'  #@param {type: \"string\"}\n","\n","\n","# 입력 데이터 변환\n","def convert_input_data(sentences):\n","\n","    # BERT의 토크나이저로 문장을 토큰으로 분리\n","    tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","    # 입력 토큰의 최대 시퀀스 길이\n","    MAX_LEN = 128\n","\n","    # 토큰을 숫자 인덱스로 변환\n","    input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","    # 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","    input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","    # 어텐션 마스크 초기화\n","    attention_masks = []\n","\n","    # 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","    # 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","    for seq in input_ids:\n","        seq_mask = [float(i>0) for i in seq]\n","        attention_masks.append(seq_mask)\n","\n","    # 데이터를 파이토치의 텐서로 변환\n","    inputs = torch.tensor(input_ids)\n","    masks = torch.tensor(attention_masks)\n","\n","    return inputs, masks\n","\n","\n","# 문장 테스트\n","def test_sentences(sentences):\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 문장을 입력 데이터로 변환\n","    inputs, masks = convert_input_data(sentences)\n","\n","    # 데이터를 GPU에 넣음\n","    b_input_ids = inputs.to(device)\n","    b_input_mask = masks.to(device)\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","\n","    return logits\n","\n","\n","logits = test_sentences([테스트용텍스트])\n","\n","print(logits)\n","print(np.argmax(logits))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 2.3737793 -2.0936546]]\n","0\n"]}]},{"cell_type":"code","metadata":{"cellView":"form","colab":{"base_uri":"https://localhost:8080/"},"id":"an-PJ7pjeo4z","outputId":"5a75df12-0b01-4ea3-bcb3-b88d78ea96c4","executionInfo":{"status":"ok","timestamp":1690959498817,"user_tz":-540,"elapsed":4,"user":{"displayName":"지해인","userId":"10118119697182884789"}}},"source":["#@title 딥러닝 모델로 예측하기\n","\n","\n","테스트용텍스트 = '\\uAC04\\uD638\\uBC95 \\uAD6D\\uD68C \\uD1B5\\uACFC\\u2026\\uAD6D\\uD798\\uC740 \\u2018\\uAC04\\uD638\\uC0AC \\uCD9C\\uC2E0\\u2019 \\uCD5C\\uC5F0\\uC219\\uB9CC \\uCC2C\\uC131'  #@param {type: \"string\"}\n","\n","\n","# 입력 데이터 변환\n","def convert_input_data(sentences):\n","\n","    # BERT의 토크나이저로 문장을 토큰으로 분리\n","    tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","    # 입력 토큰의 최대 시퀀스 길이\n","    MAX_LEN = 128\n","\n","    # 토큰을 숫자 인덱스로 변환\n","    input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","    # 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","    input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","    # 어텐션 마스크 초기화\n","    attention_masks = []\n","\n","    # 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","    # 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","    for seq in input_ids:\n","        seq_mask = [float(i>0) for i in seq]\n","        attention_masks.append(seq_mask)\n","\n","    # 데이터를 파이토치의 텐서로 변환\n","    inputs = torch.tensor(input_ids)\n","    masks = torch.tensor(attention_masks)\n","\n","    return inputs, masks\n","\n","\n","# 문장 테스트\n","def test_sentences(sentences):\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 문장을 입력 데이터로 변환\n","    inputs, masks = convert_input_data(sentences)\n","\n","    # 데이터를 GPU에 넣음\n","    b_input_ids = inputs.to(device)\n","    b_input_mask = masks.to(device)\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","\n","    return logits\n","\n","\n","logits = test_sentences([테스트용텍스트])\n","\n","print(logits)\n","print(np.argmax(logits))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[[-0.2462739   0.12010659]]\n","1\n"]}]},{"cell_type":"markdown","source":["## 심화 학습 : 테스트용 데이터 대량 입력하기"],"metadata":{"id":"GqaLKJUb9vRL"}},{"cell_type":"code","source":["#@title 데이터 불러오기 - 테스트 데이터\n","파일ID = '1DKKis8ChPNDpouzhdye24iQsAr0aBX4F'  #@param {type: \"string\"}\n","파일저장이름 = 'rawdata2.tsv'  #@param {type: \"string\"}\n","\n","# 문서 ID로 실제 파일 불러오는 법\n","## 조중동한경_정치만_각각_20161101-20161231 : https://drive.google.com/file/d/1DKKis8ChPNDpouzhdye24iQsAr0aBX4F/\n","\n","!wget --load-cookies ~/cookies.txt \"https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies ~/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id={파일ID}' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\\1\\n/p')&id={파일ID}\" -O {파일저장이름} && rm -rf ~/cookies.txt\n","\n","print(파일저장이름+\"을 정상적으로 가져왔습니다.\")\n","\n","# pandas import\n","import pandas as pd\n","\n","# 파일을 DataFrame으로 전환\n","df2 = pd.read_csv(파일저장이름, sep='\\t')\n","df2 = df2.dropna(axis=0)\n","df2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":760},"id":"lVpbkjaS9wgY","executionInfo":{"status":"ok","timestamp":1690959509169,"user_tz":-540,"elapsed":2609,"user":{"displayName":"지해인","userId":"10118119697182884789"}},"outputId":"f15526fb-6c0b-4be3-94d4-a41a408957d2","cellView":"form"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["--2023-08-02 06:58:26--  https://docs.google.com/uc?export=download&confirm=&id=1DKKis8ChPNDpouzhdye24iQsAr0aBX4F\n","Resolving docs.google.com (docs.google.com)... 173.194.79.113, 173.194.79.100, 173.194.79.101, ...\n","Connecting to docs.google.com (docs.google.com)|173.194.79.113|:443... connected.\n","HTTP request sent, awaiting response... 303 See Other\n","Location: https://doc-0o-50-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/kuljehq2jfhln16qk2pe0t3prsadp73h/1690959450000/10118119697182884789/*/1DKKis8ChPNDpouzhdye24iQsAr0aBX4F?e=download&uuid=7b9b7154-c990-46af-9ab6-90991ba1c6e5 [following]\n","Warning: wildcards not supported in HTTP.\n","--2023-08-02 06:58:27--  https://doc-0o-50-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/kuljehq2jfhln16qk2pe0t3prsadp73h/1690959450000/10118119697182884789/*/1DKKis8ChPNDpouzhdye24iQsAr0aBX4F?e=download&uuid=7b9b7154-c990-46af-9ab6-90991ba1c6e5\n","Resolving doc-0o-50-docs.googleusercontent.com (doc-0o-50-docs.googleusercontent.com)... 108.177.119.132, 2a00:1450:4013:c00::84\n","Connecting to doc-0o-50-docs.googleusercontent.com (doc-0o-50-docs.googleusercontent.com)|108.177.119.132|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 1294443 (1.2M) [text/csv]\n","Saving to: ‘rawdata2.tsv’\n","\n","rawdata2.tsv        100%[===================>]   1.23M  --.-KB/s    in 0.008s  \n","\n","2023-08-02 06:58:27 (146 MB/s) - ‘rawdata2.tsv’ saved [1294443/1294443]\n","\n","rawdata2.tsv을 정상적으로 가져왔습니다.\n"]},{"output_type":"execute_result","data":{"text/plain":["      label                                            text\n","0      경향신문                             [경향포토]새해 촛불 밝히는 어린이\n","1      경향신문                                      [경향포토]송박영신\n","2      경향신문                                   [경향포토]송박영신 축포\n","3      경향신문                                 [경향포토]정경유착 퍼포먼스\n","4      경향신문                         [경향포토]송박영신 세월호 진실을 인양하라\n","...     ...                                             ...\n","14966  중앙일보                                    [인사] 기획재정부 外\n","14967  중앙일보                    [취재일기] 이상돈도 안 최순실, 친박은 몰랐다고?\n","14968  중앙일보  평화 오디세이 2016 참가자 릴레이 기고 <12> 러시아에서 한반도 평화를 꿈꾸다\n","14969  중앙일보                   [글로벌 아이] 최순실 사태, 국가 시스템을 수술하라\n","14970  중앙일보                     [인사] SPC그룹 임원 인사 허희수 신임 부사장\n","\n","[14971 rows x 2 columns]"],"text/html":["\n","\n","  <div id=\"df-339f29db-e829-4019-8faf-1380b1fbb1a7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>label</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>경향신문</td>\n","      <td>[경향포토]새해 촛불 밝히는 어린이</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>경향신문</td>\n","      <td>[경향포토]송박영신</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>경향신문</td>\n","      <td>[경향포토]송박영신 축포</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>경향신문</td>\n","      <td>[경향포토]정경유착 퍼포먼스</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>경향신문</td>\n","      <td>[경향포토]송박영신 세월호 진실을 인양하라</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>14966</th>\n","      <td>중앙일보</td>\n","      <td>[인사] 기획재정부 外</td>\n","    </tr>\n","    <tr>\n","      <th>14967</th>\n","      <td>중앙일보</td>\n","      <td>[취재일기] 이상돈도 안 최순실, 친박은 몰랐다고?</td>\n","    </tr>\n","    <tr>\n","      <th>14968</th>\n","      <td>중앙일보</td>\n","      <td>평화 오디세이 2016 참가자 릴레이 기고 &lt;12&gt; 러시아에서 한반도 평화를 꿈꾸다</td>\n","    </tr>\n","    <tr>\n","      <th>14969</th>\n","      <td>중앙일보</td>\n","      <td>[글로벌 아이] 최순실 사태, 국가 시스템을 수술하라</td>\n","    </tr>\n","    <tr>\n","      <th>14970</th>\n","      <td>중앙일보</td>\n","      <td>[인사] SPC그룹 임원 인사 허희수 신임 부사장</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>14971 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-339f29db-e829-4019-8faf-1380b1fbb1a7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","\n","\n","\n","    <div id=\"df-d8e09731-5a33-4f25-84cb-d1cf2d02eee2\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-d8e09731-5a33-4f25-84cb-d1cf2d02eee2')\"\n","              title=\"Suggest charts.\"\n","              style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","    </div>\n","\n","<style>\n","  .colab-df-quickchart {\n","    background-color: #E8F0FE;\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: #1967D2;\n","    height: 32px;\n","    padding: 0 0 0 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: #E2EBFA;\n","    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: #174EA6;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","    background-color: #3B4455;\n","    fill: #D2E3FC;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart:hover {\n","    background-color: #434B5C;\n","    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","    fill: #FFFFFF;\n","  }\n","</style>\n","\n","    <script>\n","      async function quickchart(key) {\n","        const containerElement = document.querySelector('#' + key);\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      }\n","    </script>\n","\n","      <script>\n","\n","function displayQuickchartButton(domScope) {\n","  let quickchartButtonEl =\n","    domScope.querySelector('#df-d8e09731-5a33-4f25-84cb-d1cf2d02eee2 button.colab-df-quickchart');\n","  quickchartButtonEl.style.display =\n","    google.colab.kernel.accessAllowed ? 'block' : 'none';\n","}\n","\n","        displayQuickchartButton(document);\n","      </script>\n","      <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-339f29db-e829-4019-8faf-1380b1fbb1a7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-339f29db-e829-4019-8faf-1380b1fbb1a7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["#@title 데이터 선택하기\n","\n","데이터량 = \"14971\"  #@param ['100', '1000', '5000', '10000', '14971']\n","데이터량 = int(데이터량)\n","\n","df2 = df2.iloc[:데이터량]\n","print(df2)\n","\n","print(df2[\"label\"].groupby([df2[\"label\"]]).count())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"cellView":"form","id":"9-0dIAVh-pIK","executionInfo":{"status":"ok","timestamp":1690959512872,"user_tz":-540,"elapsed":573,"user":{"displayName":"지해인","userId":"10118119697182884789"}},"outputId":"3c689893-7040-4258-9b29-40dee1121eb2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["      label                                            text\n","0      경향신문                             [경향포토]새해 촛불 밝히는 어린이\n","1      경향신문                                      [경향포토]송박영신\n","2      경향신문                                   [경향포토]송박영신 축포\n","3      경향신문                                 [경향포토]정경유착 퍼포먼스\n","4      경향신문                         [경향포토]송박영신 세월호 진실을 인양하라\n","...     ...                                             ...\n","14966  중앙일보                                    [인사] 기획재정부 外\n","14967  중앙일보                    [취재일기] 이상돈도 안 최순실, 친박은 몰랐다고?\n","14968  중앙일보  평화 오디세이 2016 참가자 릴레이 기고 <12> 러시아에서 한반도 평화를 꿈꾸다\n","14969  중앙일보                   [글로벌 아이] 최순실 사태, 국가 시스템을 수술하라\n","14970  중앙일보                     [인사] SPC그룹 임원 인사 허희수 신임 부사장\n","\n","[14971 rows x 2 columns]\n","label\n","경향신문    5742\n","동아일보    1951\n","중앙일보    4584\n","한겨레     2694\n","Name: label, dtype: int64\n"]}]},{"cell_type":"code","source":["## 텍스트로 되어 있는 라벨을 숫자로 변환\n","df2.loc[df2.label=='조선일보', 'label']='0'\n","df2.loc[df2.label=='중앙일보', 'label']='0'\n","df2.loc[df2.label=='동아일보', 'label']='0'\n","df2.loc[df2.label=='한겨레', 'label']='1'\n","df2.loc[df2.label=='경향신문', 'label']='1'\n","\n","## label 값을 숫자로 전환\n","df2['label'] = df2['label'].apply(pd.to_numeric)\n","\n","print(df2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"i1CXugik-p1I","executionInfo":{"status":"ok","timestamp":1690959516935,"user_tz":-540,"elapsed":1645,"user":{"displayName":"지해인","userId":"10118119697182884789"}},"outputId":"fbac9510-ae67-4481-d04c-fccfbe2f0e87"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["       label                                            text\n","0          1                             [경향포토]새해 촛불 밝히는 어린이\n","1          1                                      [경향포토]송박영신\n","2          1                                   [경향포토]송박영신 축포\n","3          1                                 [경향포토]정경유착 퍼포먼스\n","4          1                         [경향포토]송박영신 세월호 진실을 인양하라\n","...      ...                                             ...\n","14966      0                                    [인사] 기획재정부 外\n","14967      0                    [취재일기] 이상돈도 안 최순실, 친박은 몰랐다고?\n","14968      0  평화 오디세이 2016 참가자 릴레이 기고 <12> 러시아에서 한반도 평화를 꿈꾸다\n","14969      0                   [글로벌 아이] 최순실 사태, 국가 시스템을 수술하라\n","14970      0                     [인사] SPC그룹 임원 인사 허희수 신임 부사장\n","\n","[14971 rows x 2 columns]\n"]}]},{"cell_type":"code","source":["#@title 테스트용 데이터 전처리\n","\n","## 전처리를 위한 기본 텍스트 정보를 탐색합니다.\n","\n","최대길이 = \"64\"  #@param ['32', '64', '128', '256']\n","최대길이 = int(최대길이)\n","배치크기 = \"64\"  #@param ['8', '16', '32', '64', '128', '256']\n","배치크기 = int(배치크기)\n","\n","test=df2  # 훈련 데이터만 제외한 데이터가 아닌 새로 가져온 데이터 df2를 테스트 데이터로 설정\n","\n","test.drop_duplicates(subset = ['text'], inplace=True) # text 열에서 중복인 내용이 있다면 중복 제거\n","test['text'] = test['text'].str.replace(\"[^ㄱ-ㅎㅏ-ㅣ가-힣 ]\",\"\") # 정규 표현식 수행\n","test['text'].replace('', np.nan, inplace=True) # 공백은 Null 값으로 변경\n","test = test.dropna(how='any') # Null 값 제거\n","print('전처리 후 테스트용 샘플의 개수 :',len(test))\n","\n","#@title 테스트 데이터 처리(훈련데이터와 동일)\n","\n","# 리뷰 문장 추출\n","sentences = test['text']\n","\n","# BERT의 입력 형식에 맞게 변환\n","sentences = [\"[CLS] \" + str(sentence) + \" [SEP]\" for sentence in sentences]\n","\n","# 라벨 추출\n","labels = test['label'].values\n","\n","# BERT의 토크나이저로 문장을 토큰으로 분리\n","tokenizer = BertTokenizer.from_pretrained(bert모델, do_lower_case=False)\n","tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","# 토큰을 숫자 인덱스로 변환\n","input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","# 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","input_ids = pad_sequences(input_ids, maxlen=최대길이, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","# 어텐션 마스크 초기화\n","attention_masks = []\n","\n","# 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","# 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","for seq in input_ids:\n","    seq_mask = [float(i>0) for i in seq]\n","    attention_masks.append(seq_mask)\n","\n","# 데이터를 파이토치의 텐서로 변환\n","test_inputs = torch.tensor(input_ids)\n","test_labels = torch.tensor(labels)\n","test_masks = torch.tensor(attention_masks)\n","\n","# 파이토치의 DataLoader로 입력, 마스크, 라벨을 묶어 데이터 설정\n","# 학습시 배치 사이즈 만큼 데이터를 가져옴\n","test_data = TensorDataset(test_inputs, test_masks, test_labels)\n","test_sampler = RandomSampler(test_data)\n","test_dataloader = DataLoader(test_data, sampler=test_sampler, batch_size=배치크기)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1690959525607,"user_tz":-540,"elapsed":8675,"user":{"displayName":"지해인","userId":"10118119697182884789"}},"outputId":"8b80d458-7bbe-4aee-d4aa-9ab960c12a55","id":"oZUS2iyIMVGm","cellView":"form"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-8-2d1456f892d2>:13: FutureWarning: The default value of regex will change from True to False in a future version.\n","  test['text'] = test['text'].str.replace(\"[^ㄱ-ㅎㅏ-ㅣ가-힣 ]\",\"\") # 정규 표현식 수행\n"]},{"output_type":"stream","name":"stdout","text":["전처리 후 테스트용 샘플의 개수 : 14872\n"]}]},{"cell_type":"code","source":["#@title 딥러닝 학습 평가하기\n","\n","라벨링 = ['bosu','jinbo']  #@param\n","\n","import time\n","import datetime\n","\n","#from sklearn.model_selection import train_test_split\n","\n","# 정확도 계산 함수\n","def flat_accuracy(preds, labels):\n","\n","    pred_flat = np.argmax(preds, axis=1).flatten()\n","    labels_flat = labels.flatten()\n","\n","    return np.sum(pred_flat == labels_flat) / len(labels_flat)\n","\n","# 시간 표시 함수\n","def format_time(elapsed):\n","\n","    # 반올림\n","    elapsed_rounded = int(round((elapsed)))\n","\n","    # hh:mm:ss으로 형태 변경\n","    return str(datetime.timedelta(seconds=elapsed_rounded))\n","\n","\n","\n","#시작 시간 설정\n","t0 = time.time()\n","\n","# 평가모드로 변경\n","model.eval()\n","\n","\n","# Tracking variables\n","predictions , true_labels, predictionsfin = [], [], []\n","\n","# 변수 초기화\n","eval_loss, eval_accuracy = 0, 0\n","nb_eval_steps, nb_eval_examples = 0, 0\n","\n","# 데이터로더에서 배치만큼 반복하여 가져옴\n","for step, batch in enumerate(test_dataloader):\n","    # 경과 정보 표시\n","    if step % 100 == 0 and not step == 0:\n","        elapsed = format_time(time.time() - t0)\n","        print('  Batch {:>5,}  of  {:>5,}.    Elapsed: {:}.'.format(step, len(test_dataloader), elapsed))\n","\n","    # 배치를 GPU에 넣음\n","    batch = tuple(t.to(device) for t in batch)\n","\n","    # 배치에서 데이터 추출\n","    b_input_ids, b_input_mask, b_labels = batch\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","    label_ids = b_labels.to('cpu').numpy()\n","\n","    # Store predictions and true labels\n","    predictions.append(logits)\n","    true_labels.append(label_ids)\n","\n","    # 출력 로짓과 라벨을 비교하여 정확도 계산\n","    tmp_eval_accuracy = flat_accuracy(logits, label_ids)\n","    eval_accuracy += tmp_eval_accuracy\n","    nb_eval_steps += 1\n","\n","print(\"\")\n","print(\"##### 테스트 모델을 통한 모델 정확도 #####\")\n","print(\"Accuracy: {0:.2f}\".format(eval_accuracy/nb_eval_steps))\n","print(\"Test took: {:}\".format(format_time(time.time() - t0)))\n","\n","\n","## 테스트 데이터를 대상으로 하는 모델 상세 평가\n","## precision = 정밀도 = 실제로는 False이지만 True로 라벨링 한 것에 집중\n","## 실제로는 스팸메일이 아니지만 스펨 메일로 라벨링하면?!\n","## recall = 재현율 = 실제 True인데 False 라벨링한 것에 집중\n","## 실제로는 코로나 감염자이지만, 코로나 감염이 아니라고 하면?!\n","## F1 = 정밀도와 재현율의 조화평균\n","\n","rounded_labels_set = []\n","rounded_predictions_set = []\n","\n","from sklearn.metrics import classification_report\n","\n","# For each input batch...\n","for i in range(len(true_labels)):\n","\n","  # The predictions for this batch are a 2-column ndarray (one column for \"0\"\n","  # and one column for \"1\"). Pick the label with the highest value and turn this\n","  # in to a list of 0s and 1s.\n","  rounded_labels = np.argmax(predictions[i], axis=1).flatten()\n","  rounded_labels_set.extend(rounded_labels)\n","  # Calculate and store the coef for this batch.\n","  rounded_predictions = true_labels[i].flatten()\n","  rounded_predictions_set.extend(rounded_predictions)\n","\n","labels = 라벨링\n","\n","print(\"\")\n","print(classification_report(rounded_labels_set, rounded_predictions_set, target_names=labels))\n","print(\"\")\n","\n","\n","## 혼란 매트릭스 - Confusion matrix\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from sklearn.metrics import confusion_matrix\n","\n","\n","# For each input batch...\n","for i in range(len(true_labels)):\n","\n","  # The predictions for this batch are a 2-column ndarray (one column for \"0\"\n","  # and one column for \"1\"). Pick the label with the highest value and turn this\n","  # in to a list of 0s and 1s.\n","  rounded_labels = np.argmax(predictions[i], axis=1).flatten()\n","  rounded_labels_set.extend(rounded_labels)\n","  # Calculate and store the coef for this batch.\n","  rounded_predictions = true_labels[i].flatten()\n","  rounded_predictions_set.extend(rounded_predictions)\n","\n","from sklearn.metrics import confusion_matrix\n","cm = confusion_matrix(rounded_labels_set, rounded_predictions_set)\n","\n","def plot_confusion_matrix(\n","    ax, matrix, labels, title='Confusion matrix', fontsize=9):\n","\n","    ax.set_xticks([x for x in range(len(labels))])\n","    ax.set_yticks([y for y in range(len(labels))])\n","\n","    # Place labels on minor ticks\n","    ax.set_xticks([x + 0.5 for x in range(len(labels))], minor=True)\n","    ax.set_xticklabels(labels, rotation=90, fontsize=fontsize, minor=True)  # rotation must be num not str\n","    ax.set_yticks([y + 0.5 for y in range(len(labels))], minor=True)\n","    ax.set_yticklabels(labels[::-1], fontsize=fontsize, minor=True)\n","\n","    # Hide major tick labels\n","    ax.tick_params(which='major', labelbottom='off', labelleft='off')\n","\n","    # Finally, hide minor tick marks\n","    ax.tick_params(which='minor', width=0)\n","\n","    # Plot heat map\n","    proportions = [1. * row / sum(row) for row in matrix]\n","    ax.pcolor(np.array(proportions[::-1]), cmap=plt.cm.Reds)\n","\n","    # Plot counts as text\n","    for row in range(len(matrix)):\n","        for col in range(len(matrix[row])):\n","            confusion = matrix[::-1][row][col]\n","            if confusion != 0:\n","                ax.text(col + 0.5, row + 0.5, int(confusion),\n","                        fontsize=fontsize,\n","                        horizontalalignment='center',\n","                        verticalalignment='center')\n","\n","    # Add finishing touches\n","    ax.grid(True, linestyle=':')\n","    ax.set_title(title, fontsize=fontsize)\n","    ax.set_xlabel('prediction', fontsize=fontsize)\n","    ax.set_ylabel('actual', fontsize=fontsize)\n","\n","    plt.show()\n","\n","\n","if __name__ == '__main__':\n","    matrix = cm\n","    labels = 라벨링\n","\n","    fig, ax = plt.subplots(figsize=(6, 6))\n","\n","    plot_confusion_matrix(ax, matrix, labels, fontsize=10)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":897},"id":"-dg703oJ_weJ","executionInfo":{"status":"ok","timestamp":1690959573041,"user_tz":-540,"elapsed":47444,"user":{"displayName":"지해인","userId":"10118119697182884789"}},"outputId":"e1ac85ca-81bd-4f64-fe27-61f7a659ed7d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["  Batch   100  of    233.    Elapsed: 0:00:20.\n","  Batch   200  of    233.    Elapsed: 0:00:40.\n","\n","##### 테스트 모델을 통한 모델 정확도 #####\n","Accuracy: 0.64\n","Test took: 0:00:46\n","\n","              precision    recall  f1-score   support\n","\n","        bosu       0.71      0.58      0.64      8005\n","       jinbo       0.59      0.72      0.65      6867\n","\n","    accuracy                           0.64     14872\n","   macro avg       0.65      0.65      0.64     14872\n","weighted avg       0.65      0.64      0.64     14872\n","\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 600x600 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAiIAAAIyCAYAAAD2YqGxAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAABU+klEQVR4nO3dd3wUdf7H8ffMbnYTSKNHIDTpSBMEEQsoHuUEsZ3tJ4oFlaaHx6l3p4h6iqdnoVhQFM9+No6zYOHAghSlCQIBBKWDdBKSbTO/P4BIJDiQBWYGX8/HI4/HZFs+g87OZ7/v737HsG3bFgAAgAtMtwsAAAC/XTQiAADANTQiAADANTQiAADANTQiAADANTQiAADANTQiAADANTQiAADANTQiAADANTQiAMrMtm3169dPFStWlGEYmjdvXtKvWadOHT3++ONJv44fGIahCRMmuF0G4CoaEeA4tGHDBg0aNEj16tVTOBxWbm6uevbsqcmTJx/RvzNp0iSNHz9e7733ntavX6+TTjop6df8+uuv1a9fvyNQ3bE3depUGYah7du3H9Lj169fr+7dux/dogCPC7pdAIAj64cfflDHjh2VnZ2thx9+WM2bN1csFtNHH32kAQMGaMmSJUfsb33//fc64YQTdNpppx2x16xSpcoRey2vikajCoVCysnJcbsUwHWMiADHmf79+8swDM2aNUsXXXSRGjZsqGbNmmnIkCGaMWNG8eNWrVql888/X+np6crMzNQf/vAHbdy4sfj+e+65R61atdJLL72kOnXqKCsrS5dddpl27dolSbrmmms0aNAgrVq1SoZhqE6dOpJKj1ZatWqle+65R9KeOOeee+5RrVq1FA6HVb16dQ0ePLj4sb98frJ1lmb8+PHKzs7We++9p0aNGqlcuXK6+OKLtXv3br344ouqU6eOKlSooMGDByuRSBQ/76WXXlLbtm2VkZGhnJwcXXHFFdq0aZOkPQ1g586dJUkVKlSQYRi65pprJEmdOnXSwIEDdeutt6py5crq2rWrpJLRzL/+9S+lp6dr2bJlJf5bNm7cWLt37z7ovgB+RyMCHEe2bt2qSZMmacCAASpfvvwB92dnZ0uSLMvS+eefr61bt+qzzz7TJ598ohUrVujSSy8t8fjvv/9eEyZM0Hvvvaf33ntPn332mUaMGCFJeuKJJ3TvvfeqZs2aWr9+vb7++utDqvHtt9/WY489pmeeeUbLli3ThAkT1Lx581IfeyTqPJjdu3dr5MiRev311zVp0iRNnTpVF1xwgT744AN98MEHeumll/TMM8/orbfeKn5OLBbTfffdp/nz52vChAn64YcfipuN3Nxcvf3225KkvLw8rV+/Xk888UTxc1988UWFQiFNmzZNTz/99AH19OnTRz169NCVV16peDyu999/X88995xeeeUVlStX7pD+bQE/IpoBjiPLly+Xbdtq3Ljxrz5u8uTJWrBggVauXKnc3FxJez6RN2vWTF9//bVOOeUUSXsagfHjxysjI0OSdNVVV2ny5Mn6+9//rqysLGVkZCgQCBxWxLBq1Srl5OSoS5cuSklJUa1atdSuXbujVufBxGIxPfXUUzrxxBMlSRdffLFeeuklbdy4Uenp6WratKk6d+6sKVOmFDc+1157bfHz69Wrp5EjR+qUU05Rfn6+0tPTVbFiRUlS1apVi5u+fRo0aKB//OMfv/pv88wzz6hFixYaPHiw3nnnHd1zzz1q06bNrz4H8DtGRIDjiG3bh/S4xYsXKzc3t/jkLklNmzZVdna2Fi9eXHxbnTp1ik/uknTCCScURxFldckll6iwsFD16tXTDTfcoHfffVfxePyY11muXLniJkSSqlWrpjp16ig9Pb3Ebfu/zuzZs9WzZ0/VqlVLGRkZOuussyTtaa6cHEpDUaFCBY0bN664QbrjjjscnwP4HY0IcBxp0KCBDMM4YhNSU1JSSvxuGIYsy/rV55imeUBDFIvFirdzc3OVl5enJ598Umlpaerfv7/OPPPMEo85FnWW9pxfe52CggJ17dpVmZmZeuWVV/T111/r3XfflbRn8qmT0qKy0nz++ecKBAJav369CgoKDuk5gJ/RiADHkYoVK6pr164aM2ZMqSexfV8rbdKkiVavXq3Vq1cX37do0SJt375dTZs2TaqGKlWqaP369cW/79y5UytXrizxmLS0NPXs2VMjR47U1KlTNX36dC1YsOCA1zqadR6uJUuWaMuWLRoxYoTOOOMMNW7c+IBRl1AoJEklJrgejq+++koPPfSQ/vvf/yo9PV0DBw5Mum7A62hEgOPMmDFjlEgk1K5dO7399ttatmyZFi9erJEjR6pDhw6SpC5duqh58+a68sorNWfOHM2aNUt9+vTRWWedpbZt2yb1988++2y9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5Bc2b96sRCJxwAqs1apV05IlS1yqCkfaqaeeqn79+rldBvCb9Y9//EO///3v9emnnxZfA2z69OlavXq1PvjgA5erw7HEHBH85hQWFmrkyJGqUaOG26UAv1lnnXWWli5dqgsuuEDbt2/X9u3bdeGFFyovL09nnHGG2+XhGGJE5BcqV66sQCCgjRs3lrh948aNysnJcakqlFWFChVkGEbx77Zta9euXSpXrpxefvllFysDUL16df397393uwy4jEbkF0KhkNq0aaPJkycXT4CzLEuTJ0/WwIED3S0Oh+2xxx4r0YiYpqkqVaqoffv2qlChgouVAdi2bZvGjRunxYsXS5KaNm2qvn37qmLFii5XhmOJb82U4o033tDVV1+tZ555Ru3atdPjjz+uf//731qyZMkhX70XwNGRn5+v5cuXS5Jat26tRx99VJ07d1bFihVVq1Ytl6vDodq3HkxWVpbatm0rSZo9e7a2b9+u//73vzrzzDNdrhDHCo3IQYwePVoPP/ywNmzYoFatWmnkyJFq376922XhME2aNEnp6ek6/fTTJe1ZqO7ZZ59V06ZNNWbMGEZFfGjq1Knq3LnzAbdfffXVrD/hI82bN1eHDh301FNPFa/pk0gk1L9/f3311VdasGCByxXiWKERwXGtefPmeuihh9SjRw8tWLBAbdu21W233aYpU6aocePGeuGFF9wuEfhNSktL07x589SoUaMSt7OOyG8Pc0RwXFu5cqWaNm0qSXr77bfVs2dPPfDAA5ozZ4569OjhcnXAb9fJJ5+sxYsXH9CILF68mHVEfmNoRHBcC4VC2r17tyTp008/VZ8+fSRJFStW1M6dO90sDfjN+fbbb4u3Bw8erFtuuUXLly/XqaeeKkmaMWOGxowZoxEjRrhVIlxANIPjWq9evRSNRtWxY0fdd999WrlypWrUqKGPP/5YAwcO1NKlS90uEfjNME1ThmHI6bRjGIYSicQxqgpuY0QEx7XRo0erf//+euutt/TUU08VL2L24Ycfqlu3bi5XB/y2rFy50u0S4EGMiAAAANcwIoLjXiKR0IQJE4oXTWrWrJl69epV/JVBAO5YtmyZpkyZok2bNsmyrBL33X333S5VhWONEREc15YvX64ePXpo7dq1xbPz8/LylJubq/fff18nnniiyxUCv03PPvusbr75ZlWuXFk5OTklVkA2DENz5sxxsTocSzQiOK716NFDtm3rlVdeKV42esuWLfq///s/maap999/3+UKgd+m2rVrq3///rr99tvdLgUuoxHBca18+fKaMWOGmjdvXuL2+fPnq2PHjsrPz3epMuC3LTMzU/PmzVO9evXcLgUuM90uADiawuGwdu3adcDt+fn5CoVCLlQEQJIuueQSffzxx26XAQ9gsiqOa+edd5769euncePGqV27dpKkmTNn6qabblKvXr1crg747apfv77uuuuu4hHLlJSUEvcPHjzYpcpwrBHN4Li2fft2XX311frvf/9b/EYXi8V0/vnna/z48crKynK5QuC3qW7duge9zzAMrVix4hhWAzfRiOA3Yfny5Vq0aJEkqWnTpqpfv77LFQEAJKIZ/AaMGzdOjz32mJYtWyZJatCggW699VZdf/31LlcGAKARwXHt7rvv1qOPPqpBgwapQ4cOkqTp06frj3/8o1atWqV7773X5QqB344hQ4bovvvuU/ny5TVkyJBffeyjjz56jKqC24hmcFyrUqWKRo4cqcsvv7zE7a+99poGDRqkzZs3u1QZ8NvTuXNnvfvuu8rOzlbnzp1/9bFTpkw5RlXBbTQiOK5lZ2fr66+/VoMGDUrcvnTpUrVr107bt293pzAAgCQaERznBg0apJSUlAOGef/0pz+psLBQY8aMcaky4Lfnwgsv1Pjx45WZmakLL7zwVx+bnp6uZs2a6aabbuLbbcc55ojguLN/9mwYhp577jl9/PHHOvXUUyXtWUdk1apV6tOnj1slAr9JWVlZxdeUcWouIpGInn76aU2bNk0TJ048FuXBJYyI4LjjlD3vYxiG/ve//x3lagCU1aJFi3TKKaeooKDA7VJwFNGIAAA8KZFIaOHChWrZsqXbpeAoohEBAACu4aJ3AADANTQiAADANTQiAADANTQiADytTp06evzxx4t/NwxDEyZMSOo1j8RrADgyWEcEgK+sX79eFSpUOKTH3nPPPZowYYLmzZtX5tcAcHTRiAA46qLRqEKh0BF5rZycHE+8BoAjg2gGwGHr1KmTBg4cqIEDByorK0uVK1fWXXfdpX2rAdSpU0f33Xef+vTpo8zMTPXr10+S9OWXX+qMM85QWlqacnNzNXjw4BKLVW3atEk9e/ZUWlqa6tatq1deeeWAv/3LWGXNmjW6/PLLVbFiRZUvX15t27bVzJkzNX78eA0fPlzz58+XYRgyDEPjx48v9TUWLFigs88+W2lpaapUqZL69eun/Pz84vuvueYa9e7dW4888ohOOOEEVapUSQMGDFAsFjuC/6rAbxONCIAyefHFFxUMBjVr1iw98cQTevTRR/Xcc88V3//II4+oZcuWmjt3ru666y59//336tatmy666CJ9++23euONN/Tll19q4MCBxc+55pprtHr1ak2ZMkVvvfWWnnzySW3atOmgNeTn5+uss87S2rVrNXHiRM2fP19//vOfZVmWLr30Ut12221q1qyZ1q9fr/Xr1+vSSy894DUKCgrUtWtXVahQQV9//bXefPNNffrppyXqkvZcDfb777/XlClT9OKLL2r8+PHFjQ2AJNgAcJjOOussu0mTJrZlWcW33X777XaTJk1s27bt2rVr27179y7xnOuuu87u169fidu++OIL2zRNu7Cw0M7Ly7Ml2bNmzSq+f/HixbYk+7HHHiu+TZL97rvv2rZt288884ydkZFhb9mypdQ6hw0bZrds2fKA2/d/jbFjx9oVKlSw8/Pzi+9///33bdM07Q0bNti2bdtXX321Xbt2bTsejxc/5pJLLrEvvfTSg/wLAThUjIgAKJNTTz21+AJmktShQwctW7ZMiURCktS2bdsSj58/f77Gjx+v9PT04p+uXbvKsiytXLlSixcvVjAYVJs2bYqf07hxY2VnZx+0hnnz5ql169aqWLFimfdj8eLFatmypcqXL198W8eOHWVZlvLy8opva9asmQKBQPHvJ5xwwq+O1gA4NExWBXBU7H9il/bEKDfeeKMGDx58wGNr1aqlpUuXHvbfSEtLK3N9hyslJaXE74ZhyLKsY/b3geMVIyIAymTmzJklfp8xY4YaNGhQYtRgfyeffLIWLVqk+vXrH/ATCoXUuHFjxeNxzZ49u/g5eXl52r59+0FraNGihebNm6etW7eWen8oFCoeoTmYJk2aaP78+SUmzU6bNk2maapRo0a/+lwAyaMRAVAmq1at0pAhQ5SXl6fXXntNo0aN0i233HLQx99+++366quvNHDgQM2bN0/Lli3Tf/7zn+JJoY0aNVK3bt104403aubMmZo9e7auv/76Xx31uPzyy5WTk6PevXtr2rRpWrFihd5++21Nnz5d0p5v76xcuVLz5s3T5s2bFYlEDniNK6+8Uqmpqbr66qu1cOFCTZkyRYMGDdJVV12latWqJfmvBMAJjQiAMunTp48KCwvVrl07DRgwQLfcckvx13RL06JFC3322WdaunSpzjjjDLVu3Vp33323qlevXvyYF154QdWrV9dZZ52lCy+8UP369VPVqlUP+pqhUEgff/yxqlatqh49eqh58+YaMWJE8ajMRRddpG7duqlz586qUqWKXnvttQNeo1y5cvroo4+0detWnXLKKbr44ot1zjnnaPTo0Un86wA4VIZt7/3iPwAcok6dOqlVq1Ylll4HgLJgRAQAALiGRgQAALiGaAYAALiGEREAAOAaGhEAAOAaGhEAAOAaGhEAAOAaGhEAAOAaGhEAAOAaGhEAAOAaGhEAAOAaGhEAAOCa/wfK/DjqtqR1jwAAAABJRU5ErkJggg==\n"},"metadata":{}}]}]}